\begin{thm}\label{thm:BassKolster}
Let $\Phi$ be a classical ($\rA,\rB,\rC,\rD$) root system of rank $\geqslant2$, $\Delta<\Phi$ its terminal subsystem of the same type, $(R,I)$ a commutative ring and its ideal, satisfying the following assumption:
\begin{itemize}
\item $\Phi=\rA_\ell$: $\sr(R,I)\leqslant\ell+1$,
\item $\Phi=\rB_\ell$: $\asr(R,I)\leqslant\ell$,
\item $\Phi=\rC_\ell$: $\sr(R,I)\leqslant2\ell$,
\item $\Phi=\rD_\ell$: $\asr(R,I)\leqslant\ell$.
\end{itemize}
Then the principal congruence subgroup $\G(\Phi,R,I)$ admits the following relative version of Bass---Kolster decomposition:
\[ \G(\Phi,R,I)=\U(\Sigma^+,I)\ \U(\Sigma^-,I)\cdot \Z\cdot \U(\Sigma^-,I)\ \U(\Sigma^+,I)\cdot \G(\Delta,R,I), \]
where $\Sigma^\pm=\Phi^\pm\setminus\Delta$ and $\Z=\{ z_{-\alpha_\mathrm{max}}(r,1)\mid r\in I \}$.
\end{thm}
\begin{proof}
\textsc{Case $\Phi=\rA_\ell$:}
For $g\in\G(\rA_\ell,R,I)$ let $(1+r_1,r_2,\ldots,r_\ell,r_{\ell+1})^t\in\Um(\ell+1,R,I)$, $r_i\in I$ be its first column. One can add the last entry to the first $\ell$ with some coefficients from $I$ to make then form a unimodular column of length $\ell$. Then $\ell$ lower transformations (with coefficients from $I$) can make the last entry equal $r_1$. Now apply $z_\gamma(-r_1,1)$, $\gamma=-\alpha_{\max}$:
\begin{multline*}
(1+r_1,r_2,\ldots,r_\ell,r_1)^t\xmapsto{x_{-\gamma}(-1)}(1,r_2,\ldots,r_\ell,r_1)^t\xmapsto{x_\gamma(-r_1)}\\\longmapsto(1,r_2,\ldots,r_\ell,0)^t\xmapsto{x_{-\gamma}(1)}(1,r_2,\ldots,r_\ell,0)^t.
\end{multline*}
Now $\ell-1$ lower transformations eliminates all the remaining entries in the first column, while $\ell$ more upper ones will make the first row trivial.

\textsc{Case $\Phi=\rC_\ell$:}
First column: $(1+r_1,r_2,\ldots,r_\ell,r_{-\ell},\ldots,r_{-1})^t\in\Um(2\ell,R,I)$. Find $c_1,\ldots,c_{-2}\in I$ such that $(1+r_1+c_1r_{-1},\ldots,r_{-2}+c_{-2}r_{-1})=(1+r_1',\ldots,r_{-2}')\in\Um(2\ell-1,R,I)$. First add $c_{-i}r_{-1}$ to $r_{-i}$ for $-i=-\ell,\ldots,-2$, so that
\[
\begin{pmatrix}
1+r_1 \\ r_i \\ r_{-i} \\ r_{-1}
\end{pmatrix}
\longmapsto
\begin{pmatrix}
1+r_1+\sum_{i=2}^\ell c_{-i}r_i\\ r_i \\ r_{-i}+c_{-i}r_{-1} \\ r_{-1}
\end{pmatrix}=
\begin{pmatrix}
1+r_{11} \\ r_i \\ r_{-i}' \\ r_{-1}
\end{pmatrix},\quad i=2,\ldots,\ell.
\]
Denote $\mathfrak{a}=\sum_{i=-\ell}^{-2} r_i'R\unlhd R$. Now add $c_ir_{-1}$ to $r_i$ for $i=2,\ldots,\ell$:
\[
\begin{pmatrix}
1+r_{11} \\ r_i' \\ r_{-i}' \\ r_{-1}
\end{pmatrix}
\longmapsto
\begin{pmatrix}
1+r_{11}+a \\ r_i+c_ir_{-1} \\ r_{-i}' \\ r_{-1}
\end{pmatrix}=
\begin{pmatrix}
1+r_{12} \\ r_i' \\ r_{-i}' \\ r_{-1}
\end{pmatrix},\quad
\begin{matrix*}[l]
a\in\mathfrak{a}\\
i=2,\ldots,\ell
\end{matrix*}
\]
Finally, add $\left(c_1+\sum_{i=2}^\ell c_ic_{-i}\right)r_{-1}$ to the first row:
\begin{multline*}
\left(1+r_1+\sum\nolimits_{i=2}^\ell c_{-i}r_i+a\right)+\left(c_1r_{-1}+\sum\nolimits_{i=2}^\ell c_ic_{-i}r_{-1}\right)=\\
=(1+r_1+c_1r_{-1})+\sum\nolimits_{i=2}^\ell c_{-i}(r_i+c_ir_{-1})+a=\\
=1+r_1'+\sum\nolimits_{i=2}^\ell c_{-i}r_i'+a=1+r_1''.
\end{multline*}
Note that $\langle 1+r_1'',r_2',\ldots,r_{-2}'\rangle=\langle 1+r_1',r_2',\ldots,r_{-2}'\rangle$, so we made the first $2\ell-1$ elements form a unimodular column.

Now we may assume that the first column $(1+r_1,\ldots,r_{-1})^t$ has its first $2\ell-1$ entries unimodular. Find $c_1,\ldots,c_{-2}\in I$ such that $c_1(1+r_1)+c_2r_2+\ldots+c_{-2}r_{-2}=r_1-r_{-1}$. Add $c_{-i}r_i$ to $r_{-1}$, $i=2,\ldots,\ell$:
\[
\begin{pmatrix}
1+r_1 \\ r_i \\ r_{-i} \\ r_{-1}
\end{pmatrix}
\longmapsto
\begin{pmatrix}
1+r_1 \\ r_i+c_{-i}r_1 \\ r_{-i} \\ r_{-1}+\sum_{i=2}^\ell c_{-i}r_{-i}
\end{pmatrix}=
\begin{pmatrix}
1+r_1 \\ r_i' \\ r_{-i} \\ r_{-11}
\end{pmatrix},\quad i=2,\ldots,\ell.
\]
Then add $c_ir_i'=c_i(r_1+c_{-i}r_{-i})$, $i=2,\ldots,\ell$ to $r_{-11}$:
\[
1+r_1\longmapsto 1+r_1,\quad r_{-11}\longmapsto r_{-1}+\sum_{i=2}^\ell c_{-i}r_{-i}+\sum_{i=2}^\ell c_i(r_i+c_{-i}r_1)=r_{-12}.
\]
Next add $(c_1-\sum_{i=2}^\ell c_ic_{-i})(1+r_1)$ to $r_{-12}$:
\begin{multline*}
r_{-12}\mapsto r_{-1}+\sum_{i=2}^\ell c_{-i}r_{-i}+\sum_{i=2}^\ell c_i(r_i+c_{-i}(1+r_1))+c_1(1+r_1)-\sum_{i=2}^\ell c_ic_{-i}(1+r_1)=\\=r_{-1}+c_1(1+r_1)+\sum_{i=2}^\ell(c_ir_i+c_{-i}r_{-i})=r_{-1}+(r_1-r_{-1})=r_1.
\end{multline*}
Again, as in case of $\rA_n$, apply $z_\gamma(-r_1,1)$ with $\gamma=-\alpha_\mathrm{max}$.
\[
\begin{pmatrix}1+r_1 \\ \vdots \\ r_1\end{pmatrix}
\xmapsto{x_{-\gamma}(-1)}
\begin{pmatrix}1 \\ \vdots \\ r_1\end{pmatrix}
\xmapsto{x_\gamma(-r_1)}
\begin{pmatrix}1 \\ \vdots \\ 0\end{pmatrix}
\xmapsto{x_{-\gamma}(1)}
\begin{pmatrix}1 \\ \vdots \\ 0\end{pmatrix}.
\]
Now apply $2\ell-2$ lower transformation to obtain zeroes on positions $i=2,\ldots,-2$, that will also add $\sum_{i=2}^\ell (r_i+r_{-i})$ to $r_{-1}$, so by one more transformation one can make the first column trivial. The same can be done with the first row, so in total we used $8\ell-3$ transformations.
\end{proof}