We now give an application of parabolic factorizations to the problem of bounded generation.
\begin{dfn} 
Let $G$ be an abstract group with a generating set $X \subset G$. %(for simplicity we assume $X=X^{-1}$ and $1\in X$),
One defines {\it the width of $G$ with respect to $X$} as the smallest natural number $N$ such that 
 every element of $G$ is a product of at most $N$ elements of $X$, i.\,e. $G=X^N$. \end{dfn}
 
\begin{lemma}\label{lemma:srRI1}
Let $I$ be an ideal of $R$ such that $\sr(I)=1$. The following statements are true.
\begin{enumerate}
 \item The width of $\SL(2, R, I)$ with respect to generators $z_\alpha(s, \xi)$ of Theorem~\ref{theorem:Tits-Vaserstein} does not exceed $4$.
 \item The width of $\SL(2, R, I)$ with respect to $1$-parameter subgroups of the form $X_\alpha(I)$ and $X_\alpha(I)^{x_{-\alpha}(1)} = \left\{z_\alpha(s,1)\mid s\in I\right\}$ does not exceed $5$.
\end{enumerate}
\end{lemma}
\begin{proof}
Let $A=\begin{psmallmatrix}a & b \\ c & d\end{psmallmatrix}\in\SL(2,R,I)$ be an element of $\SL(2, R, I)$.
The first column of $A$ is $I$-unimodular, therefore there exists $z\in I$ such that $a+cz\in R^*$.
Multiplying $A$ on the left by $x_{12}(z)$ we get matrix $A'=x_{12}(z)\cdot A=\begin{psmallmatrix}a' & b' \\ c & d\end{psmallmatrix}$ with invertible top-left corner element $a'$.
After multiplying $A'$ on the left by $x_{21}(-c/a')$ and on the right by $x_{12}(-b'/a')$ we get a diagonal matrix. 
Thus we obtain relative Gauss decomposition of $A$
\begin{equation}\nonumber
A=x_{12}(-z)\cdot x_{21}(c/a')\cdot
\begin{pmatrix} \varepsilon & 0 \\ 0 & 1/\varepsilon \end{pmatrix}
\cdot x_{12}(b'/a')=x_{12}(-z)\cdot
\begin{pmatrix} \varepsilon & 0 \\ 0 & 1/\varepsilon \end{pmatrix}
\cdot x_{21}(y) \cdot x_{12}(b'/a'),
\end{equation}
where $\varepsilon\in 1+I$ and $y\in I$. Direct calculation shows that
\begin{multline*}
\begin{pmatrix} \varepsilon & 0 \\ 0 & 1/\varepsilon \end{pmatrix} =
\begin{pmatrix} 1 & -1 \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 0 \\ 1-\varepsilon & 1 \end{pmatrix}
\begin{pmatrix} 1 & 1/\varepsilon \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 0 \\ \varepsilon^2-\varepsilon & 1 \end{pmatrix} =\\=
\begin{pmatrix} 1 & -1 \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 0 \\ 1-\varepsilon & 1 \end{pmatrix}
\begin{pmatrix} 1 & 1+z \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 1/\varepsilon-1-z \\ 0 & 1 \end{pmatrix}
\begin{pmatrix} 1 & 0 \\ \varepsilon^2-\varepsilon & 1 \end{pmatrix},
\end{multline*}
therefore
\[ A=z_{21}(1-\varepsilon,-1-z)\cdot x_{12}(1/\varepsilon-1-z)\cdot x_{21}(\varepsilon^2-\varepsilon+y)\cdot x_{12}(b'/a'), \]
which simultaneously implies both statements of the lemma.
\end{proof}

The following lemma is a corollary of Theorems~5.7 and 5.8 of \cite{LenMorStePrimitiveRoot}.
\begin{lemma}
Let $p$ be a rational prime, let $c$, $d$ be a pair of coprime integers such that $p \perp d$.
Then under the assumption of Generalized Riemann Hypothesis there exist infinitely many primes $q\equiv c\pmod{d}$ such that $p$ is a primitive root modulo $q$.
\end{lemma}

The following lemma is a relative version of \cite[Lemma~6]{VavSmSuUnitrEng} (cf. also \cite{VseUnitrZ1p}):

\begin{lemma}\label{lemma:Z1p}
Let $R=\mathbb{Z}[\sfrac{1}{p}]$ and let $I$ be an ideal of $R$.
Under the assumption of GRH the width of $\SL(2,R,I)$ with respect to generators $z_\alpha(s, \xi)$ of Theorem~\ref{theorem:Tits-Vaserstein} does not exceed $6$.
\end{lemma}

\begin{proof}
Clearly, $I$ is a principal ideal generated by some $m\in\mathbb{Z}$ not divisible by $p$.
Let $g$ be an element of $\SL(2,R,I)$. Write
\[ g=\begin{pmatrix}x & y \\ z & w\end{pmatrix},\ \text{for}\ x=p^\alpha a,\ y=p^\beta bm,\ \text{where}\ a,b,\alpha,\beta\in\mathbb{Z},\ p\nmid a,b. \]

\textsc{Case 1:} $\alpha\geqslant\beta$. 
Since $p^{\alpha-\beta}a\perp bm^2$ and $p\perp bm^2$, there exist infinitely many rational primes $q$ of the form $p^{\alpha-\beta}a+bm^2k$,
such that $p$ is a primitive root modulo $q$. 
Without loss of generality we may assume that $q$ is prime to $b$. 
Write
\[ g_1=g\cdot x_{21}(mk) =
\begin{pmatrix} p^\beta q & p^\beta bm \\ * & * \end{pmatrix}.\]
There exists $u\geqslant 1$ such that $p^u\equiv b\pmod q$, say $p^u=b+lq$. Then
\[ g_2 = g_1\cdot x_{12}(ml) =
\begin{pmatrix} p^\beta q & mp^{\beta+u} \\ * & * \end{pmatrix}. \]
Since $g_2\equiv 1\pmod m$, we can write $p^\beta q=1+cm$ for some $c$.
\begin{align*}
g_3 = & g_2\cdot x_{21}\left(\dfrac{-c}{p^{\beta+u}}\right) =
\begin{pmatrix} 1 & mp^{\beta+u} \\ * & * \end{pmatrix}, \\
g_4 = & g_3\cdot x_{12}\left(-mp^{\beta+u}\right) =
\begin{pmatrix} 1 & 0 \\ * & * \end{pmatrix}, \\
g_5 = & g_4\cdot x_{21}\left(\dfrac{c}{p^{\beta+u}}\right) =
\begin{pmatrix} 1 & 0 \\ * & * \end{pmatrix}.
\end{align*}
Notice that $g_5=g_2\cdot z_{12}\left(-mp^{\beta+u},c/p^{\beta+u}\right)$ hence $g=x_{21} \cdot z_{12} \cdot x_{12} \cdot x_{21}$
and the length of $g$ does not exceed $4$.

\textsc{Case 2:} $\alpha<\beta$. 
Since $\mathbb{Z}[\sfrac{1}{p}]/I$ is finite, there exists $k>0$ such that $p^k\equiv 1\pmod I$.
One can choose $k>\beta-\alpha$.
Then $k+\alpha>-k+\beta$ and
\[ g\cdot h_{12}\left(p^k\right) =
\begin{pmatrix} p^\alpha a & p^\beta bm \\ * & * \end{pmatrix}
\begin{pmatrix} p^k & 0 \\ 0 & p^{-k} \end{pmatrix}=
\begin{pmatrix} p^{k+\alpha} a & p^{-k+\beta} bm \\ * & * \end{pmatrix}. \]
We find ourselves in the situation of Case 1, therefore we can write $g=x_{21} \cdot z_{12} \cdot x_{12} \cdot x_{21} \cdot h_{12}$.
Finally, using the same token as in Lemma~\ref{lemma:srRI1} we get that $g=x_{21} \cdot z_{12} \cdot x_{12} \cdot z_{12} \cdot x_{21} \cdot x_{12}$.
\end{proof}

For the rest of this subsection $k$ denotes a global field. We assume that there is some finite set of places $S$ chosen on $k$. 
Let $\mathcal{O}_S$ be a Dedekind ring of arithmetic type defined by $S$ and let $I$ be any ideal of $\mathcal{O}_S$.

%Now it is easy to derive bounded generation property for $\G(\Phi,\mathcal{O}_S,I)$ from the above statements.
\begin{lemma}
Let $\Phi$ be a classical root system of rank $\geqslant 2$.
If $k$ has a real embedding, then $\G(\Phi,\mathcal{O}_S,I)$ has finite width with respect to generators $z_\alpha(s, \xi)$ of Theorem~\ref{theorem:Tits-Vaserstein}.
\end{lemma}
\begin{proof}
First of all, notice that $\asr(I) \leq \asr(\mathcal{O}_S) \leq 2$. 
By Theorem~\ref{thm:BassKolster} we can present any element of $G=\G(\Phi, \mathcal{O}_S, I)$ as a product of a finite number of generators $z_\alpha(s, \xi)$ and one element of $G_0=\G(\rA_1, \mathcal{O}_S, I)=\SL(2,\mathcal{O}_S,I)$.
Consequently, to prove the statement of the lemma it suffices to express every element $g = \begin{psmallmatrix}1+a & b \\ c & 1+d \end{psmallmatrix} \in G_0$ as a product of a finite number of generators contained in some rank $2$ subgroup of $G$ containing $G_0$.

From $\det(g)=1$ we conclude that $a+d=bc-ad\in I^2$. 
Recall that Vaserstein's congruence subgroup is defined as
\[ G(I,I)=\left\{ \begin{pmatrix}1+a & b \\ c & 1+d\end{pmatrix}\in\SL(2,\mathcal{O}_S)\;\middle|\; a,d\in I^2,\ b,c\in I \right\}. \]
Notice that $g_1=g\cdot z_{21}(a,1)$ is contained in $G(I,I)$, indeed
\[ \begin{pmatrix} 1+a & b \\ c & 1+d \end{pmatrix} \cdot \begin{pmatrix} 1-a & -a \\ a & 1+a \end{pmatrix} = \begin{pmatrix} 1+ba-a^2 & b-a-ba-a^2 \\ c+a+ad-ac & 1+bc-ac \end{pmatrix} \in G(I,I). \]
For any matrix $g'=\begin{psmallmatrix}1+a & b \\ c & 1+d\end{psmallmatrix}\in G(I,I)$ the matrix $x_{21}(-c)\cdot g'\cdot x_{12}(-b)$ lies in $\SL\left(2,\mathcal{O}_S,I^2\right)$.
Recall that if $k$ has a real embedding then $\G(\Phi, \mathcal{O}_S,I) = \E(\Phi, \mathcal{O}_S, I)$ for any ideal $I$ by virtue of \cite[Corollary~4.5]{Ma69} and \cite[Theorem~3.6]{BassMilnorSerre}.

By Lemma~\ref{lemma:Stepanov-ideal} the group $\E\left(\Phi,\mathcal{O}_S,I^2\right)$ is contained in $\E(\Phi,I)$ for any root system $\Phi\neq\rC_\ell$ of rank $\geqslant2$.
Notice that under the assumptions of the lemma it is known that $\E(\Phi,I)$ has finite width with respect to $\{x_\alpha(s)\mid\alpha\in\Phi,\ s\in I\}$, see~\cite[Theorem~3.3]{TavgenThesis}.

In remains to consider the case $\Phi=\rC_\ell$. First of all, notice that $2abc-abd\in II^{\indexbox{2}}$, indeed
\[ \det(g_1)=a^3d-3a^2bc+a^2bd+ab^2c+a^3+a^2b+a^2d+2abc-abd+1. \]
Consequently, we have that
\[ g_2=x_{21}(-a-c)\cdot g_1\cdot x_{12}(a-b)\equiv
\begin{pmatrix}
1+ab-a^2 & -ab-a^2 \\ ad-ac-abc & 1-ab+a^2
\end{pmatrix}\bmod II^{\indexbox{2}}. \]
Now for $g_3=g_2\cdot z_{12}\left(a^2-ab,1\right)$ we have that
\begin{align*}
& g_3\equiv\begin{pmatrix} 1 & -2ab \\ -abc-a^2+ab-ac+ad & 1 \end{pmatrix}\bmod II^{\indexbox{2}},\\
& g_4=x_{12}(2ab)\cdot g_3\equiv x_{21}\left(-abc-a^2+ab-ac+ad\right)\bmod II^{\indexbox{2}}.
\end{align*}
Thus $g_4\cdot x_{21}(*)\in\SL\left(2,\mathcal{O}_S,II^{\indexbox{2}}\right)$ is contained in $\E(\rC_\ell,I)$ by Lemma~\ref{lemma:Stepanov-ideal} and therefore can be expressed as a bounded product of $x_\alpha$.
\end{proof}