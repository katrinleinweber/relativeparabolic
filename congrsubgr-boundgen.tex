We now give an application of parabolic factorizations to the problem of bounded generation.
 
\begin{lemma}\label{lemma:srRI1_width}
In the assumptions of \cref{thm:srRI1} the width of $\E(\Phi,R,I)$ with respect to $\mathcal{Z}(\Pi)$ does not exceed $3\left|\Phi^+\right|+2\rk\Phi-1$.
\end{lemma}
\begin{proof}
Take an element $g\in\E(\Phi,R,I)$ and decompose it into $g=u_1 h v_2 u_3$, where $h\in\Hh(\Phi,R,I)$, $u_1,u_3\in\U(\Phi,I)$, $v_2\in\U(\Phi^-,I)$. 
Write $h=\prod_{i=1}^\ell h_{\alpha_i}(\varepsilon_i)$, $\varepsilon\in1+I$. 
Each $h_{\alpha_i}(\varepsilon_i)$ decomposes into $h_{\alpha_i}(\varepsilon_i) = x_{\alpha_i}(*) z_{-\alpha_i}(*,*) x_{-\alpha_i}(*)$ 
(see \eqref{eq:rel-tor-elementary}), and since the torus normalizes each of $X_\alpha(I)$ (see formula~\eqref{rel:h-w}), we have a decomposition
\[ g\in\U(\Phi,I)\cdot\prod_{i=1}^\ell\bigl(x_{\alpha_i}(*)z_{-\alpha_i}(*,*)\bigr)\cdot \U^-(\Phi,I) \U(\Phi,I), \]
and the estimate follows.
\end{proof}

The following lemma is a corollary of Theorems~5.7 and 5.8 of \cite{LenMorStePrimitiveRoot}.
\begin{lemma}
Let $p$ be a rational prime, let $c$, $d$ be a pair of coprime integers such that $p \perp d$.
Then under the assumption of Generalized Riemann Hypothesis there exist infinitely many primes $q\equiv c\pmod{d}$ such that $p$ is a primitive root modulo $q$.
\end{lemma}

The following lemma is a relative version of \cite[Lemma~6]{VavSmSuUnitrEng} (cf. also \cite{VseUnitrZ1p}):

\begin{lemma}\label{lemma:Z1p}
Set $R=\mathbb{Z}[\sfrac{1}{p}]$ and let $I$ be an ideal of $R$.
Under the assumption of GRH the width of $\SL(2,R,I)$ with respect to the generating set $$\mathcal{Z}(\{-\alpha_1\})=X_{12}(I)\cup X_{21}(I) \cup \{z_{21}(s, \xi) \mid s\in I,\ \xi\in R\}$$ does not exceed $6$.
\end{lemma}

\begin{proof}
Clearly, $I$ is a principal ideal generated by some integer $m\in\mathbb{Z}$ not divisible by $p$.
Let $g$ be an element of $\SL(2,R,I)$. Write
\[ g=\begin{pmatrix}x & y \\ z & w\end{pmatrix},\ \text{for}\ x=p^\alpha a,\ z=p^\beta bm,\ \text{where}\ a,b,\alpha,\beta\in\mathbb{Z},\ p\nmid a,b. \]

\textsc{Case 1:} $\alpha\geqslant\beta$. 
Since $p^{\alpha-\beta}a\perp bm^2$ and $p\perp bm^2$, there exist infinitely many rational primes $q$ of the form $p^{\alpha-\beta}a+bm^2k$,
such that $p$ is a primitive root modulo $q$. 
Without loss of generality we may assume that $q$ is prime to $b$. 
Write
\begin{align*}
g_1 & = x_{12}(mk)\cdot g =
\begin{pmatrix} p^\beta q & * \\ p^\beta bm & * \end{pmatrix}. \\
\intertext{
There exists $u\geqslant 1$ such that $p^u\equiv b\pmod q$, say $p^u=b+lq$. Then
}
g_2 & = x_{21}(ml)\cdot g_1 =
\begin{pmatrix} p^\beta q & * \\ mp^{\beta+u} & * \end{pmatrix}. \\
\intertext{
Since $g_2\equiv 1\pmod m$, we can write $p^\beta q=1+cm$ for some $c$. Now let
}
g_3 & = x_{12}\left(\dfrac{-c}{p^{\beta+u}}\right)\cdot g_2 =
\begin{pmatrix} 1 & * \\ mp^{\beta+u} & * \end{pmatrix}, \\
g_4 & = x_{21}\left(-mp^{\beta+u}\right)\cdot g_3 =
\begin{pmatrix} 1 & * \\ 0 & * \end{pmatrix}, \\
g_5 & = x_{12}\left(\dfrac{c}{p^{\beta+u}}\right)\cdot g_4 =
\begin{pmatrix} 1 & * \\ 0 & * \end{pmatrix}.
\end{align*}
Notice that $g_5=z_{21}\left(-mp^{\beta+u},c/p^{\beta+u}\right)\cdot g_2$ hence $g=x_{12} \cdot x_{21} \cdot z_{21} \cdot x_{12}$
and the length of $g$ does not exceed $4$.

\textsc{Case 2:} $\alpha<\beta$. 
Since $\mathbb{Z}[\sfrac{1}{p}]/I$ is finite, there exists $k>0$ such that $p^k\equiv 1\pmod I$.
One can choose $k>\beta-\alpha$.
Then $k+\alpha>-k+\beta$ and
\[ h_{12}\left(p^k\right)\cdot g =
\begin{pmatrix} p^k & 0 \\ 0 & p^{-k} \end{pmatrix}
\begin{pmatrix} p^\alpha a & * \\ p^\beta bm & * \end{pmatrix}=
\begin{pmatrix} p^{k+\alpha} a & * \\ p^{-k+\beta} bm & * \end{pmatrix}. \]
We find ourselves in the situation of the previous case, therefore, we can write $g=h_{12}\cdot x_{12} \cdot x_{21} \cdot z_{21} \cdot x_{12}$.
Finally, expressing $h=x_{21}\cdot z_{21}\cdot x_{12}$ as in \eqref{eq:rel-tor-elementary}, we get that $g=x_{21} \cdot z_{21} \cdot x_{12} \cdot x_{21} \cdot z_{21} \cdot x_{12}$.
\end{proof}

For the rest of this subsection $k$ denotes a global field. We assume that there is some finite set of places $S$ chosen on $k$. 
Let $\mathcal{O}_S$ be a Dedekind ring of arithmetic type defined by $S$ and let $I$ be any ideal of $\mathcal{O}_S$.

%Now it is easy to derive bounded generation property for $\G(\Phi,\mathcal{O}_S,I)$ from the above statements.
\begin{lemma}\label{lemma:width-dedekind}
Let $\Phi$ be an irreducible classical root system of rank $\ell \geqslant 2$.
If $k$ has a real embedding, then $\G(\Phi,\mathcal{O}_S,I)$ has finite width with respect to the generating set $\mathcal{Z}(\Sigma_\ell)$.
\end{lemma}
\begin{proof}
First of all, notice that $\asr(I) \leq \asr(\mathcal{O}_S) \leq 2$. 
By \cref{cor:bass-kolster-iterated} we can present any element 
of $G=\G(\Phi, \mathcal{O}_S, I)$ as a product of a finite number of generators $\mathcal{Z}(\Sigma_\ell)$ and one element of 
$\G(\{\alpha_\ell, -\alpha_\ell\}, \mathcal{O}_S, I)\cong\SL(2,\mathcal{O}_S,I)$.
Consequently, to prove the statement of the lemma it suffices to express every element 
$g = \begin{psmallmatrix}1+a & b \\ c & 1+d \end{psmallmatrix} \in G_0$
as a product of a finite number of generators contained in some rank $2$ subgroup of $G$ containing $G_0$.

From $\det(g)=1$ we conclude that $a+d=bc-ad\in I^2$. 
Recall that Vaserstein's congruence subgroup is defined as
\[ G(I,I)=\left\{ \begin{pmatrix}1+a & b \\ c & 1+d\end{pmatrix}\in\SL(2,\mathcal{O}_S)\;\middle|\; a,d\in I^2,\ b,c\in I \right\}. \]
Notice that $g_1=g\cdot z_{21}(a,1)$ is contained in $G(I,I)$, indeed
\[ \begin{pmatrix} 1+a & b \\ c & 1+d \end{pmatrix} \cdot \begin{pmatrix} 1-a & -a \\ a & 1+a \end{pmatrix} = \begin{pmatrix} 1+ba-a^2 & b-a-ba-a^2 \\ c+a+ad-ac & 1+bc-ac \end{pmatrix} \in G(I,I). \]
For any matrix $g'=\begin{psmallmatrix}1+a & b \\ c & 1+d\end{psmallmatrix}\in G(I,I)$ the matrix $x_{21}(-c)\cdot g'\cdot x_{12}(-b)$ lies in $\SL\left(2,\mathcal{O}_S,I^2\right)$.

By \cref{lemma:Stepanov-ideal} the group $\E\left(\Phi,\mathcal{O}_S,I^2\right)$ is contained in $\E(\Phi,I)$ for any root system $\Phi\neq\rC_\ell$ of rank $\geqslant2$.
Notice that under the assumptions of the lemma it is known that $\E(\Phi,I)$ has finite width with respect to $\mathcal{X}$, see~\cite{Tavgen93} or \cite[Theorem~3.3]{TavgenThesis}.

In remains to consider the case $\Phi=\rC_\ell$. First of all, notice that $2abc-abd\in II^{\indexbox{2}}$, indeed
\[ \det(g_1)=a^3d-3a^2bc+a^2bd+ab^2c+a^3+a^2b+a^2d+2abc-abd+1. \]
Consequently, we have that
\[ g_2=x_{21}(-a-c)\cdot g_1\cdot x_{12}(a-b)\equiv
\begin{pmatrix}
1+ab-a^2 & -ab-a^2 \\ ad-ac-abc & 1-ab+a^2
\end{pmatrix}\bmod II^{\indexbox{2}}. \]
Now for $g_3=g_2\cdot z_{12}\left(a^2-ab,1\right)$ we have that
\begin{align*}
& g_3\equiv\begin{pmatrix} 1 & -2ab \\ -abc-a^2+ab-ac+ad & 1 \end{pmatrix}\bmod II^{\indexbox{2}},\\
& g_4=x_{12}(2ab)\cdot g_3\equiv x_{21}\left(-abc-a^2+ab-ac+ad\right)\bmod II^{\indexbox{2}}.
\end{align*}
Thus $g_4\cdot x_{21}(*)\in\SL\left(2,\mathcal{O}_S,II^{\indexbox{2}}\right)$ is contained in $\E(\rC_\ell,I)$ by \cref{lemma:Stepanov-ideal} and therefore can be expressed as a bounded product of $x_\alpha$.
\end{proof}

\begin{proof}[Proof of \cref{thm:width}] The second assertion of the theorem is contained in \cref{lemma:srRI1_width}.
The the first and the third assertions follow from \cref{lemma:Z1p,lemma:width-dedekind}. \end{proof}