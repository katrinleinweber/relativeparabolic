\documentclass[12pt]{amsart}
\usepackage{amscd, amsmath, amssymb, amsthm, amsfonts, amstext, verbatim, enumitem, graphicx, mathtools, xfrac, hyperref, tikz-cd, nameref, thmtools}
\usepackage[utf8]{inputenc}
\usepackage[backend=biber, citestyle=numeric-comp, natbib=true, sortlocale=en_US, url=false, doi=false, eprint=true, maxbibnames=4]{biblatex}            
\usepackage[activate={true,nocompatibility}]{microtype}
\usepackage[capitalize]{cleveref}

%Bibliography
\renewbibmacro{in:}{\ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
\newbibmacro{string+doi}[1]{\iffieldundef{doi}{\iffieldundef{url}{#1}{\href{\thefield{url}}{#1}}}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat{title}{\usebibmacro{string+doi}{\mkbibemph{#1}}}
\DeclareFieldFormat[article, inproceedings, inbook, thesis]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}
\addbibresource{paper.bib}

%Theorem counters
\newlist{thmlist}{enumerate}{1}
\setlist[thmlist]{label=(\roman{thmlisti}), ref=\thethm.(\roman{thmlisti}),noitemsep}

\declaretheorem[name=Theorem, Refname={Theorem,Theorems}]{thm}
\declaretheorem[name=Proposition, Refname={Proposition,Propositions}, sibling=thm]{prop}
\declaretheorem[name=Corollary, Refname={Corollary, Corollaries}, numberwithin=section]{cor}
\declaretheorem[name=Lemma, Refname={Lemma,Lemmas}, numberwithin=section]{lemma}


\Crefname{thm}{Theorem}{Theorems}
\Crefname{lemma}{Lemma}{Lemmas}

\Crefname{cor}{Corollary}{Corollaries}
\Crefname{prop}{Proposition}{Propositions}

\Crefname{thmlisti}{Lemma}{Lemmas}

\numberwithin{equation}{section}
\theoremstyle{definition}
\newtheorem{rem}[equation]{Remark}
\newtheorem{example}[equation]{Example}
\newtheorem{dfn}[equation]{Definition}
\newtheorem{notation}[equation]{Notation}

\newtheorem*{thm*}{Theorem}
\newtheorem*{lemma*}{Lemma}

%Page layout
\textwidth 16cm 
\textheight 22cm 
\headheight 0.5cm 
\evensidemargin 0.3cm 
\oddsidemargin 0.2cm

%Math operators
\DeclareMathOperator{\K}{K}
\DeclareMathOperator{\SK}{SK}
\DeclareMathOperator{\G}{G}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\St}{St}
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\EP}{EP}
\DeclareMathOperator{\Par}{P}
\DeclareMathOperator{\B}{B}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\U}{U}
\DeclareMathOperator{\Z}{Z}
\DeclareMathOperator{\M}{M}
\DeclareMathOperator{\SR}{SR}
\DeclareMathOperator{\sr}{sr}
\DeclareMathOperator{\shape}{shape}
\DeclareMathOperator{\Rad}{Rad}
\DeclareMathOperator{\Max}{Max}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Spin}{Spin}
\DeclareMathOperator{\Epin}{Epin}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\ASR}{ASR}
\DeclareMathOperator{\asr}{asr}
\DeclareMathOperator{\Ums}{Ums}
\DeclareMathOperator{\Umd}{Umd}
\DeclareMathOperator{\rk}{rk}
\newcommand{\rA}{\mathsf{A}}
\newcommand{\rB}{\mathsf{B}}
\newcommand{\rC}{\mathsf{C}} 
\newcommand{\rD}{\mathsf{D}} 
\newcommand{\rE}{\mathsf{E}}

\makeatletter
\newcommand{\indexbox}[1]{\text{\fboxsep=.1em\fbox{\m@th$\displaystyle#1$}}}
\makeatother

\def\ssub#1{\mathchoice
   {_{\lower2pt\hbox{$\scriptstyle #1$}}}
   {_{\lower2pt\hbox{$\scriptstyle #1$}}}
   {_{\lower1.5pt\hbox{$\scriptscriptstyle #1$}}}
   {_{\!\lower1.5pt\hbox{$\scriptscriptstyle #1$}}}}

\title [Parabolic factorizations of congruence subgroups] {Parabolic factorizations and width of congruence subgroups in Chevalley groups}
\keywords {Chevalley groups, relative subgroups, stability for $\K_1$. {\em Mathematical Subject Classification (2010):} 20G40, 20G35, 19B14}
\author {Sergey Sinchuk, Andrei Smolensky}
\email {sinchukss {\it at} yandex.ru,\ andrei.smolensky {\it at} gmail.com}
\date {\today}

\begin{document}

%\begin{abstract} \end{abstract}

\maketitle

\section{Introduction}\label{sec:intro}
Let $R$ be a commutative unital ring and $\Phi$ be a reduced irreducible root system with a fixed basis of simple roots $\Pi$.
Denote by $G=\G(\Phi, R)$ the split simply-connected Chevalley group of type $\Phi$ over $R$ and by $\E(\Phi, R)$ its \emph{elementary subgroup}, 
i.\,e. the subgroup generated by root unipotents $x_\alpha(\xi)$, $\alpha\in\Phi$, $\xi\in R$ see~\cite{VP, St78, S}.
For an ideal $I \trianglelefteq R$ denote by $\G(\Phi, R, I)$ the \emph{relative Chevalley group} (also called \emph{principal congruence subgroup}) of level $I$, 
i.\,e. the kernel of the map $\G(\Phi, R)\rightarrow\G(\Phi, R/I)$ induced by the canonical projection $R\rightarrow R/I$.

The main goal of the present paper is to study parabolic factorizations of Chevalley groups and their analogues for principal congruence subgroups $\G(\Phi, R, I)$.
By a parabolic factorization we mean a decomposition of $G$ into a product of several parabolic and unipotent subgroups.
To be more specific, we study relative versions of the following three kinds of decompositions:
\begin{itemize}
\item \emph{Gauss decomposition,} i.\,e. a decomposition of the form $\E(\Phi,R)=\B \cdot \U^- \cdot \U$, where $\B$ denotes the standard Borel subgroup,
      and $\U$, $\U^-$ are the unipotent radicals of $\B$ and the opposite Borel subgroup $\B^-$;
\item \emph{Bass---Kolster decomposition} $G = \Par_i \cdot \U_i^- \cdot \U_i \cdot \U_i^-$, where 
      $\Par_i$, $\Par_i^-$ are the opposite maximal parabolic subgroups of $\G$ corresponding to $i$-th simple root of $\Phi$ and $\U_i$, $\U_i^-$ are their unipotent radicals;
\item \emph{Dennis---Vaserstein decomposition} $\E(\Phi, R) = \EP_i \cdot (\U_i^- \cap \U_j^-) \cdot \EP_j$, $i\neq j$,
      where $\EP_i$ denotes the subgroup generated by root unipotents $x_\alpha(\xi)$ contained in $\Par_i$.
\end{itemize}
%TODO: Insert some links to VIP's papers :)

%TODO: Illustrate each statement of the text below with a reference:
There are two main reasons to study parabolic factorizations.
Recall that a number of various factorizations of $\G$ are known over small-dimensional rings.
For example, Bruhat decomposition is the key instrument in the study of linear groups over fields, whereas Gauss decomposition and unitriangular factorizations are useful tools in the study of groups over local rings.
Moreover, for each particular analytic or arithmetic setting there is a special decomposition theorem (Iwasawa, Cartan and Iwahori decompositions, to mention a few).
Unfortunately, neither of these decompositions can be carried over to rings of higher dimension.
The main advantage of parabolic factorizations lies in the fact that they remain true for a broader class of rings described in terms of milder ring-theoretic assumptions formulated in terms of the \emph{stable rank} of the ground ring.
Their another advantage is that they prove useful in the study of asymptotical properties of Chevalley groups. We are going to discuss this theme in more detail below.

Let $G$ be an abstract group with a generating set $X \subset G$. 
We denote by $W(G, X)$ the \emph{width of $G$ with respect to $X$}, i.\,e. the smallest natural number $N$ such that every element of $G$ is a product of at most $N$ elements of $X$.
The problem of finding an estimate for the width of $\G(\Phi, R)$ in terms of elementary generators $x_\alpha(\xi)$ has been extensively studied in a number of works (see e.\,g. \cite{CK83, Ka82, Tavgen91, Mo07, VseUnitrZ1p, VavSmSuUnitrEng}).
Summarizing results of these works, one can hope that such width is finite only for rather narrow classes of rings of number-theoretic nature, e.\,g. localizations of Dedeking rings of arithmetic type.
For example, W.~van der Kallen has shown that the width of $\SL(3,R)$ is infinite already for a Euclidean ring $R=\mathbb{C}[t]$.

On the other hand, much less is known about the width of the relative group $\G(\Phi, R, I)$. 
Set $z_\alpha(s, \xi) = x_{\alpha}(s)^{x_{-\alpha}(\xi)}$, $s\in I$, $\xi\in R$.
It is a classical result of J.~Tits and L.~Vaserstein (see e.\,g.~\cite[Theorem~2]{Va86}) that the relative elementary group $\E(\Phi, R, I)$ is generated by
the set of elements $\mathcal{Z} = \{ z_\alpha(s,\xi) \mid \alpha \in \Phi,\ s\in I,\ \xi \in R \}.$

In fact, one can choose a smaller set of generators for $\E(\Phi, R, I)$. 
Let $\Sigma$ be any special subset of $\Phi$, (e.\,g. the set of simple roots $\Pi$ or the special part of $\Sigma_S$ of some parabolic subset of roots $S$, see section~\ref{sec:rootsys}).
Set $$\mathcal{X} = \{ x_\alpha(s) \mid \alpha\in \Phi,\ s\in I\};\ \ \mathcal{Z}(\Sigma) = \{ z_\alpha(s, \xi) \mid s \in I,\ \xi \in R, \alpha\in \Sigma \} \cup \mathcal{X}.$$ 

Now we are ready to state a recent result of A.~Stepanov.  
\begin{prop}[{\cite[Theorem~3.4]{S}}] \label{prop:Stepanov}
Let $\Phi$ be a reduced irreducible root system of rank $\geq 2$ and let $S \subset \Phi$ be any parabolic subset of roots.
Then $\E(\Phi, R, I)$ is generated as an abstract group by $\mathcal{Z}(\Sigma_S)$.
\end{prop}

Our first application of parabolic factorizations is the following theorem which gives an estimate of the width of $\G(\Phi, R, I)$ in terms of certain subsets of $\mathcal{Z}$.
\begin{thm}\label{thm:width} Let $\Phi$ be an irreducible root system, and let $I$ be an ideal of a commutative ring $R$.
\begin{enumerate}
\item If $\sr(I) = 1$, then $W(\E(\Phi,R,I),\mathcal{Z}(\Pi))\leqslant 3|\Phi^+|+2\rk(\Phi)-1$;
\item Let $p$ be a prime integer, set $R = \mathbb{Z}[\sfrac{1}{p}]$ and assume $\Phi$ is classical. Then under the assumption of the Generalized Riemann Hypothesis one has
%TODO: Now check the coefficients of \rk(\Phi) in the expression below
\begin{alignat*}{2}
& W(\E(\Phi,R,I), \mathcal{Z}(\Sigma_\ell^-))\leqslant 3|\Phi^+| + 2\rk(\Phi) + 1 & \text{ if } \Phi=\rA_\ell,\rC_\ell, \\
& W(\E(\Phi,R,I), \mathcal{Z}(\Sigma_\ell^-))\leqslant 4|\Phi^+| + \rk(\Phi) + 1 & \text{ if } \Phi=\rB_\ell,\rD_\ell;
\end{alignat*}
\item Let $\mathcal{O}_S$ be a Dedekind ring of arithmetic type embedded into some global field $k$ having a real embedding. 
Assume $\Phi$ is classical of rank $\geqslant2$, then $W(\G(\Phi,\mathcal{O}_S,I), \mathcal{Z}(\Sigma_\ell^-))$ is finite.
\end{enumerate}
\end{thm}
The particular case $\Phi = \rA_\ell$, $R = I = \mathbb{Z}$ of the above theorem is similar in spirit to a recent theorem of U.~Hadad (see ~\cite[Theorem~1.6]{Ha12}).

Another application of parabolic factorizations developed in this paper are subsystem factorizations in terms of subgroups of type $\rA_1$.
The case of a finite field $R=F$ was studied by M.~Liebeck, N.~Nikolov and A.~Shalev in~\cite{LiebNikShaSL2}.
More precisely, for an untwisted Chevalley group it has been proved that $\G(\Phi, F)$ is a product of at most $N=5|\Phi^+|$ copies of $\SL(2, F)$.
In~\cite{VavKovSL2} N.~Vavilov and E.~Kovach noted that Bruhat decomposition immediately implies a bound of $N=3|\Phi^+|$ factors for arbitrary field $F$.
In fact, Gauss decomposition (see~\cite{Sm12}) implies a similar factorization for the elementary subgroup $\E(\Phi, R)$ 
with $3|\Phi^+|$ factors for arbitrary commutative ring of stable rank $1$.

In the linear and symplectic case the above results can be extended to even larger class of rings (which e.\,g. includes all Dedekind rings).
\begin{thm}\label{thm:SL2width}
Let $I\trianglelefteq R$ be an ideal, $\Phi$ be a classical root system. Then under a suitable stability assumption the prncipal congruence subgroup $\G(\Phi,R,I)$ can be presented as a product of at most $N$ copies of its subgroups isomorphic to $\G(\rA_1,R,I)$, where the stability assumption and the corresponding value of $N$ is as follows:
%TODO: Constants for A and C - where do they come from?
\[\begin{array}{l@{\quad}l@{\quad}l}
\Phi=\rA_\ell, & \sr(I)\leqslant 2, & N=3\left|\Phi^+\right|+\rk(\Phi) - 3; \\
\Phi=\rC_\ell, & \sr(I)\leqslant 3, & N=3\left|\Phi^+\right|+2\rk(\Phi) - 4; \\
\Phi=\rB_\ell,\rD_\ell, & \asr(I)\leqslant 2, & N=4\left|\Phi^+\right|.
\end{array}\]
\end{thm}

Yet another application of parabolic factorizations concerns subsystem factorizations of Chevalley groups formulated in terms of submaximal subgroups of type $\rA_\ell$.
In case when $R=I$ is a field this question was studied by N.~Nikolov in \cite{NikProdDecomp}. 
\begin{thm*} Let $G$ be a classical Chevalley group (of normal or twisted type) of rank $n$ over a finite field.
Then $G$ equals the product of at most $200$ conjugates of $\SL_n$. \end{thm*}

It is also classically known that over an arbitrary field $F$ the group $\SL_{n+1}(F)$, $n\geq 3$ is a product of at most $4$ subgroups of type $\SL(n, F)$.
On the other hand, from the classical Dennis---Vaserstein theorem (see~\cite{Va69} and \cite[Lemma~2.1]{ST76})
it follows that $\SL_{n+1}(R, I)$ is a product of a most $5$ subgroups of type $\SL_n(R, I)$ for any ideal $I$ satisfying $\sr(I)\leqslant n-1$.
Using another Dennis---Vaserstein type factorization we obtain the following result.
\begin{thm}\label{thm:spin-sln-prod}
Assume that $\sr(I) \leqslant 2$ then the group $\Epin_{2\ell}(R, I)=\E(\rD_\ell, R, I)$ is a product of at most $9$ copies of its subgroups of type $\rA_{\ell-1}$.
\end{thm}

\subsection{Acknowledgements}
Authors of the present paper acknowledge financial support from Russian Science Foundation grant 14-11-00297.

\section{Preliminaries}\label{sec:prelim}
For any collection of subsets $H_1,\ldots, H_n$ of a group $G$ we denote by $H_1\ldots H_n$ their Minkowski set-product,
i.\,e. the set consisting of arbitrary products $h_1\ldots h_n$ of elements $h_i\in H_i$. In particular, the equality
$G = H_1\cdot\ldots\cdot H_n$ means that every element $g\in G$ can be presented as a product $h_1\ldots h_n$ for $h_i\in H_i$.

\subsection{Root systems}\label{sec:rootsys}
Let $\Pi=\{\alpha_1, \ldots, \alpha_l\}$ be a basis of $\Phi$. Denote by $\Phi^+$ and $\Phi^-$ subsets of positive and negative roots with respect to $\Pi$.
Denote by $m_i(\alpha)$ the coefficient of $\beta$ in the expansion of $\alpha$ in $\Pi$, i.\,e. $\alpha = \sum_{i=1}^n m_i(\alpha) \alpha_i$.

A root subset $S\subseteq \Phi$ is called {\it parabolic} (resp. {\it reductive}, resp. {\it special}) if $\Phi=S \cup -S$ (resp. $S = -S$, resp. $S \cap -S=\varnothing$).
Any parabolic subset $S \subseteq \Phi$ can be decomposed into the disjoint union of its reductive and special part, i.e. 
$S = \Sigma_S \sqcup \Delta_S$, where $\Sigma_S \cap (-\Sigma_S) = \varnothing$, $\Delta_S = -\Delta_S$.

We denote by $(\alpha, \beta)$ the scalar product of roots and by $\langle \alpha, \beta\rangle$ the integer $2(\alpha, \beta)/(\beta, \beta)$.
Denote by $W(\Phi)$ the subgroup of isometries of $\Phi$ generated by all reflections $\sigma_\alpha$ where $\sigma_\alpha(\beta)=\beta-\langle\alpha,\beta \rangle\cdot \alpha$.
For a reductive subset $\Delta\subseteq \Phi$ denote by $W(\Delta)$ the subgroup of $W(\Phi)$ generated by $\sigma_\alpha$ for $\alpha\in\Delta$.

Let $J\subseteq \Pi$ be a subset of simple roots. 
For a root $\beta = \sum m_i(\beta)\alpha_i \in \Phi$ set $\shape(J, \beta):=\sum\limits_{i\in J} m_i(\beta) \alpha_i$.
Set $$\Delta_J = \{\alpha \in \Phi \mid \shape(J, \alpha)=0\},\quad \Sigma^\pm_J = \{\alpha \in \Phi \mid \shape(J, \alpha)\in\mathbb{Z}_{\geqslant0}\Phi^\pm \}, \quad S_J^\pm := \Delta_J \sqcup \Sigma_J^\pm.$$
Clearly, $\Delta_J$ is a reductive subset, while $S^\pm_J$ and $\Sigma^\pm_J$ are parabolic and special subsets, respectively.
For two disjoint subsets $I, J\subseteq \Pi$ one has 
\[ \Sigma^\pm_{I \cup J} = \Sigma^\pm_I\cup\Sigma^\pm_J, \quad \Delta_{I\cup J} = \Delta_I \cap \Delta_J. \]

\begin{lemma}[{\cite[Lemma~1]{ABS}}]\label{lemma:abs}
Let $\alpha, \beta \in \Sigma^\pm_J$ be two roots having the same length such that $\shape(J,\alpha)=\shape(J,\beta)\neq 0$.
Then $\alpha$ and $\beta$ are conjugate under the action of $W(\Delta_J)$.
\end{lemma}

\subsection{Chevalley groups}
Our exposition of Chevalley groups is standard and follows~\cite{Ta, S, St78, VP, Va86}.
We denote by $\G(\Phi, R)$ the simply-connected split Chevalley group of type $\Phi$ over arbitrary commutative ring $R$. For example, for each of the four classical series $\Phi=\rA_\ell, \rB_\ell, \rC_\ell, \rD_\ell$
the group $\G(\Phi, R)$ equals $\SL(\ell+1, R)$, $\Spin(2\ell+1, R)$, $\Sp(2\ell, R)$, $\Spin(2\ell, R)$, respectively. Notice that from the uniqueness theorem of M.~Demazure (see~\cite[Corollaire~5.2]{SGA3}) 
it follows that the exceptional isomorphisms of small-rank groups (which are well-known in the theory of groups over fields) remain valid for Chevalley groups over arbitrary commutative rings.
In particular, there are isomorphisms of groups $\Spin(3,R)\cong\SL(2,R)$, $\Spin(5, R)\cong \Sp(4, R)$, $\Spin(6, R)\cong\SL(4, R)$, $\SL(2, R)\cong \Sp(2, R)$.  

In this paper we work with the irreducible representations of Chevalley groups with the highest weight
$\varpi_1$ (in the case of a classical $\Phi$) or $\varpi_\ell$ (in the case $\Phi=\rE_\ell$, $\ell=6,7$). The former are the natural vector representations of classical groups acting on free modules $V=R^n$ of dimension $n=\ell+1, 2\ell+1, 2\ell,2\ell$ for $\Phi=\rA_\ell,\rB_\ell,\rC_\ell,\rD_\ell$ respectively.
The latter are the microweight representations of dimension $n=27, 56$ for $\ell=6,7$.

For a representation $\pi$ of $\G(\Phi, R)$ on $V$ we denote by $\Lambda=\Lambda(\pi)$ the set of weights of $\pi$ and by $V_\lambda$ the weight subspace corresponding to $\lambda\in\Lambda$.

\textbf{TODO: Give definitions of $\Lambda^*$, $V^0$, the notion of ``basic representation''. }

For any of the representations described above (with the sole exception of $(\rE_8, \varpi_8)$) all weight subspaces $V_\lambda$ are one-dimensional. 
This allows us to choose a basis $E_\pi=\{e_\lambda\}_{\lambda\in\Lambda}$.

It will be convenient to use the standard numbering for the weights of the natural representations of classical groups (cp.~\cite[§1B]{St78}):
\[\begin{array}{cll}
  1,2,\ldots, \ell+1 & \text{in the case} & \Phi =\rA_\ell, \\
  1,2,\ldots \ell, 0, -\ell,\ldots, -2, -1 & \text{in the case} & \Phi =\rB_\ell, \\
  1,2,\ldots \ell, -\ell,\ldots, -2, -1 & \text{in the cases}   & \Phi =\rC_\ell, \rD_\ell. \\
\end{array}\]
For example, we write $1$ instead of $\varpi_1$, $2$ instead of $\varpi_1-\alpha_1$ etc.

For a weight $\lambda\in \Lambda$ we denote by $(-)_\lambda\colon V\to R$ the coordinate function corresponding to $\lambda$.
In other words,  $v_\lambda$ is the coefficient of the basis vector $e_\lambda$ in the expansion of $v$ in $E_\pi$, i.e. $v=\sum_{\lambda\in \Lambda} v_\lambda e_\lambda$.
We denote by $v^+$ the basis vector corresponding to the highest weight.
For classical $\Phi$ we have $v^+=e_1$.

\subsection{Elementary subgroup}\label{sec:elementary}
Recall from~\cite{St78, VP} that for $\alpha\in \Phi$, $\xi\in R$ one can define certain elements $x_{\alpha}(\xi)$ of $\G_{sc}(\Phi, R)$ called {\it elementary root unipotents}.
These elements satisfy the well-known Steinberg relations:
\begin{align}
& \phantom{[}
x_\alpha(s) x_\alpha(t) = x_\alpha(s+t), \label{rel:add}\\
& [x_\alpha(s),  x_\beta(t)] = \prod x_{i\alpha + j\beta}\left(N_{\alpha\beta ij}\, s^i t^j\right),\quad \alpha\neq-\beta, \quad N_{\alpha\beta ij}\in\mathbb{Z}. \label{rel:CCF}
\end{align} 
The indices $i$, $j$ in the above formula range over all positive natural numbers such that $i\alpha + j\beta\in\Phi$.
The integers $N_{\alpha\beta ij}$ are called {\it structure constants} of the Chevalley group $\G(\Phi,R)$ and depend only on $\Phi$.
We refer the reader to~\cite[\S14]{VP} for basic properties of structure constants.

For an additive subset $I\subseteq R$ we denote by $X_\alpha(I)$ the corresponding \emph{root subgroup} of level $I$, i.\,e. the subgroup consisting of all elementary root unipotents $x_\alpha(\xi)$, $\xi\in I$.

The subgroup $\E(\Phi, R)$, generated by all $X_\alpha(R)$, $\alpha\in\Phi$ is called the {\it elementary subgroup} of the Chevalley group $\G_{sc}(\Phi, R)$.

The following result of H.~Matsumoto describes the action of elementary root unipotents in a basic representation of $\G(\Phi, R)$.
\begin{lemma}[{\cite[Lemma~2.3]{Ma69}}]\label{lemma:Matsumoto}
Let $(V, \pi)$ be a basic representation of $\G(\Phi, R)$.
One can choose a basis $v^\lambda$, $\lambda\in\Lambda(\pi)$ of $V$ such that the action of the elementary root unipotents $x_\alpha(\xi)$ on it is described by the following formulae:
 
\begin{tabular}{ll}
If $\lambda\in\Lambda^*,\ \lambda+\alpha\notin\Lambda$, then & $x_\alpha(\xi)v^\lambda=v^\lambda$; \\
If $\lambda,\lambda+\alpha\in\Lambda^*$, then & $x_\alpha(\xi)v^\lambda=v^\lambda\pm\xi v^{\lambda+\alpha}$; \\
If $\alpha\notin\Lambda^*$, then & $x_\alpha(\xi)v^0=v^0$ for any $v^0\in V^0$; \\
If $\alpha\in\Lambda^*$, then & $x_\alpha(\xi)v^{-\alpha}=v^{-\alpha}\pm\xi v^0(\alpha)\pm\xi^2 v^\alpha$ and \\
& $x_\alpha(\xi)v^0=v^0\pm\xi\alpha_*(v^0)v^\alpha$.
\end{tabular}
% \begin{thmlist}
%  \item $x_{\alpha}(\xi) v_\lambda = v_\lambda$ for $\lambda\in\Lambda^*(\pi), \lambda+\alpha\not\in\Lambda(\pi)$;
%  \item $x_\alpha(\xi)v_\lambda=v_\lambda\pm\xi v_{\lambda+\alpha}$ for $\lambda,\lambda+\alpha\in\Lambda^*(\pi)$;
%  \item $x_\alpha(\xi)v_0 = v_0$ for every $v_0\in V^0$, $\alpha\not\in\Lambda^*(\pi)$;
%  \item $x_\alpha(\xi)v_{-\alpha}=v_{-\alpha}\pm\xi v_0(\alpha)\pm\xi^2 v_{\alpha}$,\\
%   $x_\alpha(\xi)v_0 = v_0\pm\xi\alpha_*(v_0)v_\alpha$ for $\alpha\in\Lambda^*(\pi)$.
% \end{thmlist}
\end{lemma}

\begin{rem}
Let $\lambda_1, \lambda_2 \in \Lambda(\pi)$ be a pair of weights of a representation $\pi$ of a classical group such that $\lambda_1-\lambda_2\in \Phi$.
In this situation it will be convenient for us to write $x_{\lambda_1,\lambda_2}(\xi)$ (for some choice of $\lambda_1,\lambda_2$) instead of $x_{\lambda_1-\lambda_2}(\xi)$.
For example, for $\Phi=\rA_\ell$ we have $x_{1,2}(\xi)=x_{1-2}(\xi)=x_{\varpi_1 - \varpi_1 + \alpha_1}(\xi) = x_{\alpha_1}(\xi)$. This is done in order to fix the signs in \cref{lemma:Matsumoto}.
\end{rem}
For classigal groups there is a standard way to fix the signs.
In case $\Phi=\rC_\ell$ the long and short root unipotents are
\begin{align*}
& x_{i,-i}(\xi)=e+\xi e_{i,-i}, \\ 
& x_{i,j}(\xi)=e+\xi e_{ij}-\varepsilon_i\varepsilon_j\xi e_{-j,-i},\quad i\neq\pm j.
\end{align*}
Here $\varepsilon_i$ is the sign of $i$.
In case $\Phi=\rB_\ell,\rD_\ell$ the long and short root unipotents in $\SO(n,R)$ are
\begin{align*}
& x_{i,j}(\xi)=e+\xi e_{ij}-\xi e_{-j,-i},\quad i\neq\pm j,\ i,j\neq0, \\
& x_{i0}(\xi)=e+2\xi e_{i0}-\xi e_{0,i}-\xi^2 e_{i,-i},\quad i\neq0.
\end{align*}

For $\varepsilon\in R^*$ set $w_\alpha(\varepsilon) = x_\alpha(\varepsilon) x_{-\alpha}(-\varepsilon^{-1}) x_{\alpha}(\varepsilon).$
If $\rk(\Phi)\geqslant 2$ the following relation is a consequence of \ref{rel:add}--\ref{rel:CCF}:
\begin{equation}\label{rel:R3}
w_\alpha(\varepsilon) x_{\beta}(\xi) w_\alpha(\varepsilon)^{-1} =
x_{\sigma\ssub{\alpha}\beta} \left(\eta_{\alpha, \beta}\cdot\varepsilon^{-\langle\beta,\alpha \rangle}\xi\right),\quad \varepsilon\in R^*,\ \xi\in R.
\end{equation}
where $\eta_{\alpha, \beta}=\pm 1$. The coefficients $\eta_{\alpha, \beta}$ can be expressed through structure constants (cf.~\cite[\S13]{VP}).
For a reductive subset $\Delta \subseteq \Phi$ denote by $\widetilde{W}(\Delta)$ the \emph{extended Weyl group}, i.\,e. the subgroup of $\E(\Phi, R)$ generated by all $w_{\alpha}(1)$, $\alpha \in \Delta$.
\begin{lemma} \label{lemma:weylfacts} Let $\Phi$ be an irreducible root system and let $I$ be an ideal of $R$. 
\begin{thmlist}
\item \label{item-trans1} For every roots $\alpha, \beta \in \Phi$ of the same length there exists $w \in \widetilde{W}(\Phi)$ such that $X_{\alpha}(I)^w = X_\beta(I)$.
\item \label{item-egen} The elementary group $\E(\Phi, R)$  is generated as an abstract group by root subgroups $X_{\alpha}(R)$, $\alpha \in \Pi \cup -\Pi$.
\item \label{item-trans2} Assume that $\alpha_s\in \Pi$ is a simple root of $\Phi$ such that $m_s(\alpha_\mathrm{max}) = 1$. 
Then for $\alpha, \beta \in \Sigma^\pm_s$ of the same length there exists $w\in \widetilde{W}(\Delta_s)$ such that $X_\alpha(I)^w = X_\beta(I)$.

\end{thmlist}
\end{lemma}
\begin{proof}
The first statement of the lemma follows from identity~\ref{rel:R3} and the well-known fact that the Weyl group $W(\Phi)$ acts transitively on the set of roots of the same length.
 
The same argument combined with~\cref{lemma:abs} also proves the third statement. Indeed, by our assumption all roots of the same length lying in $\Sigma_s$ have the same $s$-shape.
 
To prove the second assertion notice that the subgroup $\langle X_\alpha(R) \mid \alpha \in \Pi \cup -\Pi \rangle$ contains $\widetilde{W}(\Phi)$ and therefore contains all other root subgroups $X_\alpha(R)$, $\alpha\in \Phi$. \end{proof}

Define semisimple root elements $h_\alpha(\varepsilon)$, $\alpha\in\Phi$, $\varepsilon\in R^*$ as $h_\alpha(\varepsilon)=w_\alpha(\varepsilon)w_\alpha(-1)$.
The elements $h_\alpha(\varepsilon)$ satisfy the following relations:
\begin{alignat}{2}
& [ h_\alpha(\varepsilon_1), h_\beta(\varepsilon_2)] = 1, &\quad& \alpha, \beta \in \Phi,\ \varepsilon_1, \varepsilon_2 \in R^*; \label{rel:h-comm} \\
& \phantom{[} h_\alpha(\varepsilon_1 \varepsilon_2) = h_\alpha(\varepsilon_1) h_\alpha(\varepsilon_2), && \alpha \in \Phi,\ \varepsilon_1, \varepsilon_2 \in R^*; \label{rel:h-mult} \\
& \phantom{[} h_\alpha(\varepsilon)x_\beta(\xi)h_\alpha(\varepsilon)^{-1} = x_\beta\left(\varepsilon^{\langle\beta,\alpha\rangle}\xi\right), && \alpha, \beta \in \Phi,\ \varepsilon \in R^*, \xi \in R. \label{rel:h-w}
\end{alignat}

\subsection{Relative Chevalley groups}\label{sec:relative-elementary}
Let $I\leq R$ be an ideal. Denote by $\E(\Phi, I)$ the subgroup of $\G_{sc}(\Phi, R)$ generated by the elementary root unipotents $x_\alpha(\xi)$, $\alpha\in\Phi$, $\xi\in I$.

We denote by $\E(\Phi, R, I)$ the normal closure of $\E(\Phi, I)$ in $\E(\Phi, R)$, in other words $\E(\Phi, R, I) = \E(\Phi, I)^{\E(\Phi, R)}$.
Recall from the introduction that the elements $z_\alpha(s, \xi) = x_\alpha(s)^{x\ssub{-\alpha}(\xi)}$ generate $\E(\Phi, R, I)$ as an abstract group.

\begin{lemma}[{\cite[Corollary~3.3]{S}}]\label{lemma:Stepanov-ideal}
Let $\Phi$ be a root system of rank $\geqslant2$, let $R$ be a commutative ring and $I\trianglelefteq R$ be its ideal.
If $\Phi\neq\rC_\ell$ then $\E\left(\Phi,R,I^2\right)\leqslant\E(\Phi,I)$, otherwise $\E\left(\Phi,R,II^{\indexbox{2}}\right)\leqslant\E(\Phi,I)$.
\end{lemma}
Here $I^{\indexbox{2}}$ denotes the ideal generated by squares $a^2$, where $a\in I$.
Recall also that $I^2$ is generated by products $ab$ for all $a,b\in I$.
Clearly, $II^{\indexbox{2}}$ is generated by elements of the form $a^2b$ for $a,b\in I$.

For a special subset of roots $\Sigma\subseteq \Phi$ we denote by $\U(\Sigma, I)$ the subgroup spanned by all $x_{\alpha}(I)$ for $\alpha\in \Sigma$. Let $J\subset\Pi$.
The subgroup $\U(\Sigma_J, I)$ is normalized by $\E(\Delta_J, R)$, hence the Minkowski product set $\EP_J(R, I) = \E(\Delta_J, R, I) \cdot \U(\Sigma_J, I)$ is a subgroup called a \emph{standard parabolic subgroup}.
The following two equalities will be referred to in the sequel as {\it Levi decomposition}: 
\begin{equation} \label{rel:Levi-decomp} \EP_J(R, I) = \U(\Sigma_J, I) \cdot \E(\Delta_J, R, I) = \E(\Delta_J, R, I) \cdot \U(\Sigma_J, I). \end{equation}
When $J = \{ \alpha_s \}$ for some $1 \leq s\leq \ell$ we use shorthand $\EP_s(R, I)$ for $\EP_{\{s\}}(R, I)$.
When $I=R$ we also write $\EP_J(R)$ instead of $\EP_J(R, R)$.

Denote by $\Hh(\Phi,R)$ the subgroup generated by all $h_\alpha(\varepsilon)$, $\alpha\in\Phi$, $\varepsilon\in R^*$, and set
\[ \Hh(\Phi,R,I) = \Hh(\Phi,R)\cap\G(\Phi,R,I)=\langle h_\alpha(\varepsilon),\ \alpha\in\Phi,\ \varepsilon\in R^*\cap(1+I)\rangle. \]
\begin{lemma}\label{lemma:rel-tor-elementary}
$\Hh(\Phi,R,I)$ is contained in $\E(\Phi,R,I)$.
\end{lemma}
\begin{proof}
Set $\varepsilon=1+s$, $s\in I$ and write
\begin{multline*}
h_\alpha(1+s) = x_\alpha\left(-1\middle)\, x_{-\alpha}\middle(-s\middle)\, x_\alpha\middle((1+s)^{-1}\middle)\, x_{-\alpha}\middle(s(1+s)\right) = \\
= x_\alpha\left((1+s)^{-1}-1\middle)\, z_{-\alpha}\middle(-s,(1+s)^{-1}\middle)\, x_{-\alpha}\middle(s(1+s)\right).
\end{multline*}
It remains to note that $(1+s)^{-1}\in 1+I$ and so all the factors lie in $\E(\Phi,R,I)$.
\end{proof}

The following lemma is a relative version of the classical result sometimes called Chevalley---Matsumoto decomposition.
\begin{lemma}\label{lemma:Chevalley-Matsumoto}
Let $\pi$ be the fundamental representation of $\G_{sc}(\Phi, R)$ with the highest weight $\varpi_s$.
Assume that $g\in \G_{sc}(\Phi, R, I)$ is such that $(g\cdot v^+)_{\varpi\ssub{s}}=1$, then 
\[ g \in \U(\Sigma_s^-, I) \cdot \G_{sc}(\Delta_s, R, I) \cdot \U(\Sigma_s^+, I). \]
\end{lemma}
\begin{proof}
In the absolute case ($I=R$) the statement of the lemma is contained in~\cite[Theorem~1.3]{St78}. 
Thus we can write $g=u_1\cdot g'\cdot u_2$, where $u_1\in\U(\Sigma_s^-,R)$, $u_2\in\U(\Sigma_s^+,R)$ and $g'\in\G(\Delta_s,R)$.
Since $g$ lies in $\G(\Phi,R,I)$, the vector $gv^+$ is $I$-unimodular. 
On the other hand, $g'u_2v^+=v^+$, so $u_1\in\G(\Phi,R,I)\cap\U(\Sigma_s^-,R)=\U(\Sigma_s^-,I)$.
The matrix $g'u_2$ is an element of $\left(\G(\Delta_s,R)\U(\Sigma_s^+,R)\right)\cap\G(\Phi,R,I)$, and by Levi decomposition $u_2\in\U(\Sigma_s^+,I)$, $g'\in\G(\Delta_s,R,I)$.
\end{proof}

\subsection{$\K_1$-functor modeled on Chevalley groups}
Recall that by Taddei's theorem $\E(\Phi, R)$ is a normal subgroup of $\G_{sc}(\Phi, R)$ provided $\Phi$ is an irreducible root system of rank $\geqslant 2$ (see~\cite{Ta}).

Using standard relativization argument it is not hard to deduce from Taddei's result that $\E(\Phi,R,I)$ is normal in $\G(\Phi,R,I)$ under the same assumptions on $\Phi$.
This allows us to define the relative $\K_1$-group as $\K_1(\Phi,R,I)=\G(\Phi,R,I)/\E(\Phi,R,I).$
When $I=R$, we write $\K_1(\Phi, R)$ for $\K_1(\Phi, R, R)$.

In some cases it is known that $\K_1(\Phi, R, I)$ is trivial.
For example, $\SK_1(\ell+1,R)=\K(\rA_\ell,R)=1$ for any ring of stable rank $1$ (see Section~\ref{sec:stability-conditions}), 
and for other root systems some stronger assumption is required such as $\asr(R)=1$ or being semilocal. 
For any Euclidean ring $\K_1(\Phi, R, I)$ is trivial for every root system $\Phi$.

Let $k$ be a global field, $S$ be a set of places of $k$, 
$\mathcal{O}_S$ be the Dedekind ring of arithmetic type defined by $S$ and $I$ be an ideal of $\mathcal{O}_S$.
\begin{prop} \label{prop:K1triv}
Let $\Phi$ be a root system of rank $\geqslant2$. Assume that the field $k$ has a real embedding. Then $\K_1(\Phi,\mathcal{O}_S,I)=1$.
\end{prop}
\begin{proof} Follows from \cite[Theorem~3.6]{BassMilnorSerre} and \cite[Corollary~4.5]{Ma69}. \end{proof}

\section{Stability conditions}\label{sec:stability-conditions}
\input{stability-conditions}

\section{Relative parabolic factorizations} \label{sec:factorizations}
%TODO: Add references to works of Dennis, Bass, Vaserstein, Suslin etc.
In this section we formulate and prove relative versions of decompositions from~\cite{St78} which will be our main technical tools throughout the next section.

\subsection{Relative Gauss decomposition}\label{sec:gauss}
\input{gauss}
\subsection{Relative Bass---Kolster decompositions}\label{sec:bass-kolster}
\input{bass-kolster}
\subsection{Relative Dennis---Vaserstein decompositions}\label{sec:dennis-vaserstein}
\input{dennis-vaserstein}

%\section{Applications} %\label{sec:applications}
\section{Bounded generation}\label{sec:boundgen}
\input{congrsubgr-boundgen}
\section{Subsystem factorizations}\label{sec:subsysfact}
\input{subsystem-factorizations}

\printbibliography

\end{document}
