\documentclass[12pt]{amsart}
\usepackage{amscd, amsmath, amssymb, amsthm, amsfonts, amstext, verbatim, enumitem, graphicx, mathtools, xfrac, tikz-cd, nameref, thmtools, hyperref}
\usepackage[utf8]{inputenc}
\usepackage[backend=biber, citestyle=numeric-comp, natbib=true, sortlocale=en_US, url=false, doi=false, eprint=true, maxbibnames=4]{biblatex}            
\usepackage[activate={true,nocompatibility}]{microtype}
\usepackage[capitalize]{cleveref}

%Bibliography
\renewbibmacro{in:}{\ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
\newbibmacro{string+doi}[1]{\iffieldundef{doi}{\iffieldundef{url}{#1}{\href{\thefield{url}}{#1}}}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat{title}{\usebibmacro{string+doi}{\mkbibemph{#1}}}
\DeclareFieldFormat[article, inproceedings, inbook, thesis]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}
\addbibresource{paper.bib}

\newlist{thmlist}{enumerate}{1} \setlist[thmlist]{label=(\roman{thmlisti}), ref=\thethm.(\roman{thmlisti}),noitemsep} \Crefname{thmlisti}{Theorem}{Theorems}
\newlist{lemlist}{enumerate}{1} \setlist[lemlist]{label=(\roman{lemlisti}), ref=\thelemma.(\roman{lemlisti}),noitemsep} \Crefname{lemlisti}{Lemma}{Lemmas}

\theoremstyle{plain} \declaretheorem[name=Theorem, Refname={Theorem,Theorems}]{thm} \Crefname{thm}{Theorem}{Theorems}
\numberwithin{equation}{section}

\newtheorem{lemma}{Lemma} \numberwithin{lemma}{section} \Crefname{lemma}{Lemma}{Lemmas}
\newtheorem{cor}[lemma]{Corollary} \Crefname{cor}{Corollary}{Corollaries}
\newtheorem{prop}[lemma]{Proposition} \Crefname{prop}{Proposition}{Propositions}
\newtheorem*{thm*}{Theorem}
\newtheorem*{lemma*}{Lemma}
\theoremstyle{definition} \newtheorem{dfn}[lemma]{Definition} \Crefname{dfn}{Definition}{Definitions}
\newtheorem{example}[lemma]{Example} \Crefname{example}{Example}{Examples}
\theoremstyle{remark} \newtheorem{rem}[lemma]{Remark} \Crefname{rem}{Remark}{Remarks}

%Page layout
\textwidth 16cm 
\textheight 22cm 
\headheight 0.5cm 
\evensidemargin 0.3cm 
\oddsidemargin 0.2cm

%Math operators
\DeclareMathOperator{\K}{K}
\DeclareMathOperator{\SK}{SK}
\DeclareMathOperator{\G}{G}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\Sp}{Sp}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\St}{St}
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\EP}{EP}
\DeclareMathOperator{\Par}{P}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\B}{B}
\DeclareMathOperator{\Hh}{H}
\DeclareMathOperator{\U}{U}
\DeclareMathOperator{\Z}{Z}
\DeclareMathOperator{\M}{M}
\DeclareMathOperator{\SR}{SR}
\DeclareMathOperator{\sr}{sr}
\DeclareMathOperator{\shape}{shape}
\DeclareMathOperator{\Rad}{Rad}
\DeclareMathOperator{\Max}{Max}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Spin}{Spin}
\DeclareMathOperator{\Epin}{Epin}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\ASR}{ASR}
\DeclareMathOperator{\asr}{asr}
\DeclareMathOperator{\Ums}{Ums}
\DeclareMathOperator{\Umd}{Umd}
\DeclareMathOperator{\rk}{rk}
\newcommand{\rA}{\mathsf{A}}
\newcommand{\rB}{\mathsf{B}}
\newcommand{\rC}{\mathsf{C}} 
\newcommand{\rD}{\mathsf{D}} 
\newcommand{\rE}{\mathsf{E}}
\newcommand{\rF}{\mathsf{F}}
\newcommand{\rG}{\mathsf{G}}

\makeatletter
\newcommand{\indexbox}[1]{\text{\fboxsep=.1em\fbox{\m@th$\displaystyle#1$}}}
\makeatother

\def\ssub#1{\mathchoice
   {_{\lower2pt\hbox{$\scriptstyle #1$}}}
   {_{\lower2pt\hbox{$\scriptstyle #1$}}}
   {_{\lower1.5pt\hbox{$\scriptscriptstyle #1$}}}
   {_{\!\lower1.5pt\hbox{$\scriptscriptstyle #1$}}}}

\newcommand\restr[2]{\ensuremath{\left.#1\right|_{#2}}}   
   
\title {Decompositions of congruence subgroups of Chevalley groups}
\keywords {Chevalley groups, principal congruence subgroups, stability for $\K_1$, bounded generation, $\SL_2$-factorizations. {\em Mathematical Subject Classification (2010):} 20G40, 20G35, 19B14}
\author {Sergey Sinchuk, Andrei Smolensky}
\email {sinchukss {\it at} yandex.ru,\ andrei.smolensky {\it at} gmail.com}
\date {\today}

\begin{document}

\begin{abstract} 
We formulate and prove relative versions of several classical decompositions known in the theory of Chevalley groups over commutative rings. % Gauss, Bass---Kolster and Dennis---Vaserstein decompositions.
As an application we obtain upper estimates for the width of principal congruence subgroups in terms of several families of generators.
Some of our results are new even in the absolute case and were previously studied only for groups over finite fields.
\end{abstract}

\maketitle

\section{Introduction}\label{sec:intro}
%Let $R$ be a commutative unital ring and $\Phi$ be a reduced irreducible root system of rank $\ell$ with a fixed basis of simple roots.
Let $\G(\Phi, R)$ the split simply-connected Chevalley group of type $\Phi$ over arbitarary commutative ring $R$ and let $\E(\Phi, R)$ be its \emph{elementary subgroup}
i.\,e. the subgroup generated by root unipotents $x_\alpha(\xi)$, $\alpha\in\Phi$, $\xi\in R$ see~\cite{VP, St78, S}.
For an ideal $I \trianglelefteq R$ we denote by $\G(\Phi, R, I)$ the \emph{relative Chevalley group} (aka \emph{principal congruence subgroup}) of level $I$, 
i.\,e. the kernel of the map $\G(\Phi, R)\rightarrow\G(\Phi, R/I)$ induced by the canonical projection $R\rightarrow R/I$.

In our theorems we also use the notion of the \emph{relative elementary Chevalley group} $\E(\Phi, R, I) \leq \G(\Phi, R, I)$.
Recall that $\E(\Phi, R, I)$ is defined as the normal closure in $\E(\Phi, R)$ of the subgroup generated by the set $\mathcal{X} = \{x_\alpha(\xi) \mid \alpha\in \Phi,\ \xi \in I \}$.

Set $z_\alpha(s, \xi) = x_{\alpha}(s)^{x_{-\alpha}(\xi)}$, $s\in I$, $\xi\in R$.
It is a classical result of J.~Tits and L.~Vaserstein (see~\cite{Tits76}, \cite[Theorem~2]{Va86}) that the relative elementary group $\E(\Phi, R, I)$ is generated by
the set of elements $\mathcal{Z}(\Phi) = \{ z_\alpha(s,\xi) \mid s\in I,\ \xi \in R,\ \alpha \in \Phi\}.$

The following recent result of A.~Stepanov served as a starting point for the present paper.
The notation for the subgroups involved in the statements of our results below is introduced properly in section~\ref{sec:prelim}.
\begin{prop}[{\cite[Theorem~3.4]{S}}] \label{prop:Stepanov}
Let $\Phi$ be a reduced irreducible root system of rank $\geq 2$, let $S \subset \Phi$ be any parabolic subset of roots.
Let $\Sigma_S$ be the special part of $S$, then $\E(\Phi, R, I)$ is generated as an abstract group by the set $\mathcal{Z}(\Sigma_S)$, where
$$\mathcal{Z}(\Sigma) = \mathcal{X} \cup \{ z_\alpha(s, \xi) \mid s \in I,\ \xi \in R,\ \alpha\in \Sigma \}.$$ \end{prop}

The purpose of this paper is two-fold. 
First, we obtain relative analogues of several classical parabolic factorizations of Chevalley groups such as Gauss, Bass---Kolster and Dennis---Vaserstein decompositions.
Secondly, we apply these factorizations to the study of various bounded generation properties of Chevalley groups over rings.
%To be more specific, we study relative analogues of the following three kinds of decompositions:
%\begin{itemize}
%\item \emph{Gauss decomposition,} i.\,e. a decomposition of the form $\E(\Phi,R)=\B \cdot \U^- \cdot \U$, where $\B$ denotes the standard Borel subgroup,
%      and $\U$, $\U^-$ are the unipotent radicals of $\B$ and the opposite Borel subgroup $\B^-$;
%\item \emph{Bass---Kolster decomposition} $G = \Par_i \cdot \U_i^- \cdot \U_i \cdot \U_i^-$, where 
%      $\Par_i$, $\Par_i^-$ are the opposite maximal parabolic subgroups of $\G$ corresponding to $i$-th simple root of $\Phi$ and $\U_i$, $\U_i^-$ are their unipotent radicals;
%\item \emph{Dennis---Vaserstein decomposition} $\E(\Phi, R) = \EP_i \cdot (\U_i^- \cap \U_j^-) \cdot \EP_j$, $i\neq j$,
%      where $\EP_i$ denotes the subgroup generated by root unipotents $x_\alpha(\xi)$ contained in $\Par_i$.
%\end{itemize}
%TODO: Insert some links to VIP's papers :)

%TODO: Illustrate each statement of the text below with a reference:
%There are two main reasons to study parabolic factorizations.
%Recall that a number of various factorizations of $\G$ are known over small-dimensional rings.
%For example, Bruhat decomposition is the key instrument in the study of linear groups over fields, whereas Gauss decomposition and unitriangular factorizations are useful tools in the study of groups over local rings.
%Moreover, for each particular analytic or arithmetic setting there is a special decomposition theorem (Iwasawa, Cartan and Iwahori decompositions, to mention a few).
%Unfortunately, neither of these decompositions can be carried over to rings of higher dimension.
%The main advantage of parabolic factorizations lies in the fact that they remain true for a broader class of rings described in terms of milder ring-theoretic assumptions formulated in terms of the \emph{stable rank} of the ground ring.
%Their another advantage is that they prove useful in the study of asymptotical properties of Chevalley groups. We are going to discuss this theme in more detail below.

Our first result is a relative version of Gauss decomposition formulated in terms of the \emph{stable rank} of the ideal $I$ (see section~\ref{sec:stability-conditions} for the definition)
\begin{thm}\label{thm:srRI1}
Let $\Phi$ be a root system, let $I$ be an ideal of arbitrary commutative ring $R$ such that $\sr(I)=1$.
Then the relative elementary Chevalley $\E(\Phi, R, I)$ group admits the following decomposition
\[ \E(\Phi,R,I) = \Hh(\Phi,R,I) \cdot \U(\Phi,I) \cdot \U(\Phi^-,I) \cdot \U(\Phi,I). \]
\end{thm}
In the special case when $I$ is contained in the Jacobson radical of $R$ the above theorem boils down to~\cite[Proposition~2.3]{AbeSuzNormalSubgroups}. 
The special case $I=R$ was treated by the second named author in~\cite{Sm12}.

The next main result is a relative Dennis---Vaserstein decomposition which holds for a broader class of groups of rings as compared to \cref{thm:srRI1}.
\begin{thm}\label{thm:DennisVaserstein}
Let $\Phi \neq \rE_8$ be a reduced irreducible root system and let $\{ r, s \}$ be a pair of distinct terminal vertices of the Dynkin diagram of $\Phi$ the distance between which equals $d$.
Assume that $\Phi$ and $I$ satisfy either of the following assumptions:
\begin{enumerate}
 \item $\asr(I) \leq d$ for $\Phi=\rF_4$ or $\Phi=\rE_\ell$, $\{r, s\} = \{1, \ell \}$,
 \item $\sr(I) \leq d$, otherwise.
\end{enumerate}
Then $\E(\Phi, R, I) = \EP_r(R, I) \cdot \U(\Sigma^-_r \cap \Sigma^-_s, I) \cdot \EP_s(R, I).$ \end{thm}
Even in the special case $I=R$ the above theorem contains several new cases as compared to~\cite[Theorems~2.5, 4.1]{St78}.
The term ``Dennis---Vaserstein decomposition'' is due to A.~Suslin and M.~Tulenbaev (cf.~\cite[Lemma~2.1]{ST76}).

The condition $\asr(I) \leq d$ used in the statement of \cref{thm:DennisVaserstein} is a relative version of the \emph{absolute stable range} condition of D.~Estes and J.~Ohm which depends only on the ideal $I$ (see section~\ref{sec:rel-asr}).

Let $G$ be an abstract group with a generating set $X \subset G$. 
We denote by $W(G, X)$ the \emph{width of $G$ with respect to $X$}, i.\,e. the smallest natural number $N$ such that every element of $G$ is a product of at most $N$ elements of $X$.
%The problem of finding an estimate for the width of $\G(\Phi, R)$ in terms of elementary generators $x_\alpha(\xi)$ has been extensively studied in a number of works (see e.\,g. \cite{CK83, Ka82, Tavgen91, Mo07, VseUnitrZ1p, VavSmSuUnitrEng}).
%Summarizing results of these works, one can hope that such width is finite only for rather narrow classes of rings of number-theoretic nature, e.\,g. localizations of Dedeking rings of arithmetic type.
%For example, W.~van der Kallen has shown that the width of $\SL(3,R)$ is infinite already for a Euclidean ring $R=\mathbb{C}[t]$.

%On the other hand, much less is known about the width of the relative group $\G(\Phi, R, I)$ and the relative elementary group $\E(\Phi, R, I)$.

Our first application of parabolic factorizations is the following theorem which gives an estimate of the width of $\E(\Phi, R)$ in terms of Tits generators and is, thus, a quantitative analogue of \cref{prop:Stepanov}
and a relative analogue of the results of~\cite{CK83, Tavgen91, Mo07, VseUnitrZ1p, VavSmSuUnitrEng}.
\begin{thm}\label{thm:width} Let $I$ be an ideal of a commutative ring $R$.
\begin{enumerate}
\item If $R=\mathcal{O}_S$ is a Dedekind ring of arithmetic type posessing a real embedding and $\Phi$ is classical of rank $\geqslant2$, then 
$W(\G(\Phi,\mathcal{O}_S,I), \mathcal{Z}(\Sigma_\ell^-))$ is finite.
\item If $\sr(I) = 1$ and $\Phi$ is arbitrary irreducible root system then 
\[W(\E(\Phi,R,I),\mathcal{Z}(\Pi))\leqslant 3|\Phi^+|+2\rk(\Phi)-1;\]
\item If $R = \mathbb{Z}[\sfrac{1}{p}]$ for some prime number $p$, then under the assumption of the Generalized Riemann Hypothesis one has
\begin{alignat*}{2}
& W(\E(\Phi,R,I), \mathcal{Z}(\Sigma_\ell^-))\leqslant 3|\Phi^+| + 2\rk(\Phi) + 1 & \text{ if } \Phi=\rA_\ell,\rC_\ell, \\
& W(\E(\Phi,R,I), \mathcal{Z}(\Sigma_\ell^-))\leqslant 4|\Phi^+| + \rk(\Phi) + 1 & \text{ if } \Phi=\rB_\ell,\rD_\ell;
\end{alignat*}
\end{enumerate}
\end{thm}
The first assertion of the above theorem is essentially a reformulation of a previously known result of O.~Tavgen (see \cite{Tavgen93, TavgenThesis}),
while for the second and the third assertion we give a direct proof.
Compare \cref{thm:width} with a recent result of U.~Hadad and D.~W.~Morris \cite[Theorem~1.6]{Ha12} which asserts that 
$W(\SL(n, \mathbb{Z}, I), \mathcal{Z}(\Pi))$ is finite for any ideal $I \leq \mathbb{Z}$ and $n \geq 3$.

Another application of parabolic factorizations developed in this paper are subsystem factorizations in terms of subgroups of type $\rA_1$.
The case of a finite field $R=F$ was studied by M.~Liebeck, N.~Nikolov and A.~Shalev in~\cite{LiebNikShaSL2}.
More precisely, for an untwisted Chevalley group it has been proved that $\G(\Phi, F)$ is a product of at most $N=5|\Phi^+|$ copies of $\SL(2, F)$.

In~\cite{VavKovSL2} N.~Vavilov and E.~Kovach noted that Bruhat decomposition immediately implies a bound of $N=3|\Phi^+|$ factors for arbitrary field $F$.
In fact, in the context of \cref{thm:srRI1} one can immediately obtain the decomposition of $\E(\Phi, R, I)$ with $3|\Phi^+|$ factors of type $\rA_1$.
Our next result further extends this to even larger class of rings (which e.\,g. includes ideals of all Dedekind rings).
\begin{thm}\label{thm:SL2width}
Let $I\trianglelefteq R$ be an ideal, $\Phi$ be an irreducible classical root system satisfying the following assumptions.
\[\begin{array}{l@{\quad}l@{\quad}l}
\Phi=\rA_\ell, & \sr(I)\leqslant 2, & N=3\left|\Phi^+\right| - \rk(\Phi) - 1; \\
\Phi=\rC_\ell, & \sr(I)\leqslant 3, & N=3\left|\Phi^+\right| - 2; \\
\Phi=\rB_\ell,\rD_\ell, & \asr(I)\leqslant 2, & N=4\left|\Phi^+\right| - 3\rk(\Phi).
\end{array}\]
Then the principal congruence subgroup $\G(\Phi,R,I)$ can be presented as a product of at most $N$ copies of its (regularly embedded) subgroups isomorphic to $\SL_2(R, I)$.
\end{thm}

Our yet another application of parabolic factorizations concerns product decompositions of Chevalley groups formulated in terms of subgroups of type $\rA_\ell$ of submaximal rank.
Recall that in \cite{NikProdDecomp} N.~Nikolov proves the following result. 
\begin{thm*} Let $G$ be a classical Chevalley group (of normal or twisted type) of rank $n$ over a finite field.
Then $G$ equals the product of at most $200$ conjugates of $\SL_n$. \end{thm*}

It is classically known that over an arbitrary field $F$ the group $\SL_{n+1}(F)$, $n\geq 3$ is a product of at most $4$ subgroups of type $\SL(n, F)$.
On the other hand, one immediately obtains from \cref{thm:DennisVaserstein} that $\SL_{n+1}(R, I)$ factors into a product of a most $5$ subgroups of type $\SL_n(R, I)$ for any ideal $I$ satisfying $\sr(I)\leqslant n-1$.

Applying \cref{thm:DennisVaserstein} and generalizing Nikolov's \cite[Proposition~1]{NikProdDecomp} in the special case $\Phi=\rD_\ell$ to arbitrary rings we obtain the following result.
\begin{thm}\label{thm:spin-sln-prod}
Assume that $\sr(I) \leqslant 2$. Then the group $\Epin_{2\ell}(R, I)=\E(\rD_\ell, R, I)$ is a product of at most $9$ conjugates of its (regularly embedded) subgroups of type $\rA_{\ell-1}$.
\end{thm}

The rest of the article is organized as follows.
In sections \ref{sec:prelim}--\ref{sec:stability-conditions} we introduce principal notation pertaining to Chevalley groups and stability conditions.
In section \ref{sec:factorizations} we prove our parabolic factorizations and thus obtain Theorems~\ref{thm:srRI1}, \ref{thm:DennisVaserstein} and \ref{thm:SL2width}.
Finally, we treat bounded generation and product decompositions separately in section~\ref{sec:applications} where Theorems~\ref{thm:width} and \ref{thm:spin-sln-prod} are proved.

\subsection{Acknowledgements}
Authors of the present paper acknowledge financial support from Russian Science Foundation grant 14-11-00297.

\section{Preliminaries}\label{sec:prelim}
For any collection of subsets $H_1,\ldots, H_n$ of a group $G$ we denote by $H_1\ldots H_n$ their Minkowski set-product,
i.\,e. the set consisting of arbitrary products $h_1\ldots h_n$ of elements $h_i\in H_i$. In particular, the equality
$G = H_1\cdot\ldots\cdot H_n$ means that every element $g\in G$ can be presented as a product $h_1\ldots h_n$ for $h_i\in H_i$.

\subsection{Root systems}\label{sec:rootsys}
Let $\Phi$ be a reduced irreducible root system of rank $\ell$ with a fixed basis of simple roots $\Pi=\{\alpha_1, \ldots, \alpha_l\}$.
We use conventional numbering of basis vectors of $\Pi$ which follows Bourbaki (cf.~\cite[Table~1]{PSV98}).
Denote by $\Phi^+$ and $\Phi^-$ the subsets of positive and negative roots with respect to $\Pi$.
Let $\alpha_\mathrm{max}$ denote the maximal root of $\Phi$.
For a root $\alpha\in\Phi$ we denote by $m_i(\alpha)$ the $i$-th component of $\alpha$ in $\Pi$, i.\,e. $\alpha = \sum_{i=1}^n m_i(\alpha) \alpha_i$.

A proper closed subset of roots $S\subseteq \Phi$ is called {\it parabolic} (resp. {\it reductive}, resp. {\it special}) if $\Phi=S \cup -S$ (resp. $S = -S$, resp. $S \cap -S=\varnothing$).
Any parabolic subset $S \subseteq \Phi$ can be decomposed into the disjoint union of its \emph{reductive} and \emph{special} parts, i.e. 
$S = \Sigma_S \sqcup \Delta_S$, where $\Sigma_S \cap (-\Sigma_S) = \varnothing$, $\Delta_S = -\Delta_S$.

We denote by $(\alpha, \beta)$ the scalar product of roots and by $\langle \alpha, \beta\rangle$ the integer $2(\alpha, \beta)/(\beta, \beta)$.
Let $\varpi_1, \ldots, \varpi_\ell$ be the \emph{fundamental weights }of $\Phi$, i.\,e. vectors
defined by $\langle\varpi_i,\alpha_j^\vee\rangle=\delta_{i,j},$ where $\alpha^\vee = \frac{\alpha}{2(\alpha,\alpha)}$.

Denote by $W(\Phi)$ the subgroup of isometries of $\Phi$ generated by all reflections $\sigma_\alpha$ where $\sigma_\alpha(\beta)=\beta-\langle\alpha,\beta \rangle\cdot \alpha$.
For a reductive subset $\Delta\subseteq \Phi$ denote by $W(\Delta)$ the subgroup of $W(\Phi)$ generated by $\sigma_\alpha$ for $\alpha\in\Delta$.

Let $J\subseteq \Pi$ be a subset of simple roots. 
For a root $\beta = \sum m_i(\beta)\alpha_i \in \Phi$ define \emph{$J$-shape} of $\beta$ (denoted $\shape(J, \beta)$) as $\sum_{i\in J} m_i(\beta) \alpha_i$.
Set
\begin{align*}
& \Delta_J = \{\alpha \in \Phi \mid \shape(J, \alpha)=0\},\\
& \Sigma^\pm_J = \{\alpha \in \Phi \mid \shape(J, \alpha) \in \mathbb{Z}_{\geqslant0} \Phi^\pm \},\\
& S_J^\pm = \Delta_J \sqcup \Sigma_J^\pm.
\end{align*}
Clearly, $\Delta_J$ is a reductive subset, while $S^\pm_J$ and $\Sigma^\pm_J$ are parabolic and special subsets, respectively.
For two disjoint subsets $I, J\subseteq \Pi$ one has 
\[ \Sigma^\pm_{I \cup J} = \Sigma^\pm_I\cup\Sigma^\pm_J, \quad \Delta_{I\cup J} = \Delta_I \cap \Delta_J. \]
We tend to omit curly braces in the above notations in the case when $J$ is a one or two element set, e.\,g. $\Delta_k=\Delta_{\{k\}}$ and $\Sigma_{i,j}=\Sigma_{\{i,j\}}$ etc.

\begin{lemma}[{\cite[Lemma~1]{ABS}}]\label{lemma:abs}
Let $\alpha, \beta \in \Sigma^\pm_J$ be two roots having the same length such that $\shape(J,\alpha)=\shape(J,\beta)\neq 0$.
Then $\alpha$ and $\beta$ are conjugate under the action of $W(\Delta_J)$.
\end{lemma}

\subsection{Chevalley groups and their elementary subgroups} \label{sec:elementary}
Our exposition of Chevalley groups is standard and follows~\cite{Ta, S, St78, VP, Va86}.
We denote by $\G(\Phi, R)$ the simply-connected split Chevalley group of type $\Phi$ over arbitrary commutative ring $R$. For example, for each of the four classical series $\Phi=\rA_\ell, \rB_\ell, \rC_\ell, \rD_\ell$
the group $\G(\Phi, R)$ equals $\SL(\ell+1, R)$, $\Spin(2\ell+1, R)$, $\Sp(2\ell, R)$, $\Spin(2\ell, R)$, respectively. 

Notice that from the uniqueness theorem of M.~Demazure (see~\cite[Corollaire~5.2]{SGA3}) 
it follows that the exceptional isomorphisms of small-rank groups (which are well-known in the theory of groups over fields) remain valid for Chevalley groups over arbitrary commutative rings.
In particular, there are isomorphisms of groups $\Spin(3,R)\cong\SL(2,R)$, $\Spin(5, R)\cong \Sp(4, R)$, $\Spin(6, R)\cong\SL(4, R)$, $\SL(2, R)\cong \Sp(2, R)$.  

Recall from~\cite{St78, VP} that for $\alpha\in \Phi$, $\xi\in R$ one can define certain elements $x_{\alpha}(\xi)$ of $\G_{sc}(\Phi, R)$ called {\it elementary root unipotents}.
These elements satisfy the well-known Steinberg relations:
\begin{align}
& \phantom{[}
x_\alpha(s) x_\alpha(t) = x_\alpha(s+t), \label{rel:add}\\
& [x_\alpha(s),  x_\beta(t)] = \prod x_{i\alpha + j\beta}\left(N_{\alpha\beta ij}\, s^i t^j\right),\quad \alpha\neq-\beta, \quad N_{\alpha\beta ij}\in\mathbb{Z}. \label{rel:CCF}
\end{align} 
The indices $i$, $j$ in the above formula range over all positive natural numbers such that $i\alpha + j\beta\in\Phi$.
The integers $N_{\alpha\beta ij}$ are called {\it structure constants} of the Chevalley group $\G(\Phi,R)$ and depend only on $\Phi$.
We refer the reader to~\cite[\S14]{VP} for basic properties of structure constants.

For an additive subset $I\subseteq R$ we denote by $X_\alpha(I)$ the corresponding \emph{root subgroup} of level $I$, i.\,e. the subgroup consisting of all elementary root unipotents $x_\alpha(\xi)$, $\xi\in I$.

The subgroup $\E(\Phi, R)$, generated by all $X_\alpha(R)$, $\alpha\in\Phi$ is called the {\it elementary subgroup} of the Chevalley group $\G_{sc}(\Phi, R)$.

For $\varepsilon\in R^*$ set $w_\alpha(\varepsilon) = x_\alpha(\varepsilon) x_{-\alpha}(-\varepsilon^{-1}) x_{\alpha}(\varepsilon).$
If $\rk(\Phi)\geqslant 2$ the following relation is a consequence of \eqref{rel:add}--\eqref{rel:CCF}:
\begin{equation}\label{rel:R3}
w_\alpha(\varepsilon) x_{\beta}(\xi) w_\alpha(\varepsilon)^{-1} =
x_{\sigma\ssub{\alpha}\beta} \left(\eta_{\alpha, \beta}\cdot\varepsilon^{-\langle\beta,\alpha \rangle}\xi\right),\quad \varepsilon\in R^*,\ \xi\in R.
\end{equation}
where $\eta_{\alpha, \beta}=\pm 1$. The coefficients $\eta_{\alpha, \beta}$ can be expressed through structure constants (cf.~\cite[\S13]{VP}).
For a reductive subset $\Delta \subseteq \Phi$ denote by $\widetilde{W}(\Delta)$ the \emph{extended Weyl group}, i.\,e. the subgroup of $\E(\Phi, R)$ generated by all $w_{\alpha}(1)$, $\alpha \in \Delta$.
\begin{lemma} \label{lemma:weylfacts} Let $\Phi$ be an irreducible root system and let $I$ be an ideal of $R$. 
\begin{lemlist}
\item \label{item-trans1} For every roots $\alpha, \beta \in \Phi$ of the same length there exists $w \in \widetilde{W}(\Phi)$ such that $X_{\alpha}(I)^w = X_\beta(I)$.
\item \label{item-egen} The elementary group $\E(\Phi, R)$  is generated as an abstract group by root subgroups $X_{\alpha}(R)$, $\alpha \in \Pi \cup -\Pi$.
\item \label{item-trans2} Assume that $\alpha_s\in \Pi$ is a simple root of $\Phi$ such that $m_s(\alpha_\mathrm{max}) = 1$. 
                          Then for $\alpha, \beta \in \Sigma^\pm_s$ of the same length there exists $w\in \widetilde{W}(\Delta_s)$ such that $X_\alpha(I)^w = X_\beta(I)$. \end{lemlist}
\end{lemma}
\begin{proof}
The first statement of the lemma follows from identity~\eqref{rel:R3} and the well-known fact that the Weyl group $W(\Phi)$ acts transitively on the set of roots of the same length.
 
The same argument combined with \cref{lemma:abs} also proves the third statement. Indeed, by our assumption all roots of the same length lying in $\Sigma_s$ have the same $s$-shape.
 
To prove the second assertion notice that the subgroup $\langle X_\alpha(R) \mid \alpha \in \Pi \cup -\Pi \rangle$ contains $\widetilde{W}(\Phi)$ and therefore contains all other root subgroups $X_\alpha(R)$, $\alpha\in \Phi$. \end{proof}

Define semisimple root elements $h_\alpha(\varepsilon)$, $\alpha\in\Phi$, $\varepsilon\in R^*$ as $h_\alpha(\varepsilon)=w_\alpha(\varepsilon)w_\alpha(-1)$.
The elements $h_\alpha(\varepsilon)$ satisfy the following relations:
\begin{alignat}{2} 
& [ h_\alpha(\varepsilon_1), h_\beta(\varepsilon_2)] = 1, &\quad& \alpha, \beta \in \Phi,\ \varepsilon_1, \varepsilon_2 \in R^*; \label{rel:h-comm} \\
& \phantom{[} h_\alpha(\varepsilon_1 \varepsilon_2) = h_\alpha(\varepsilon_1) h_\alpha(\varepsilon_2), && \alpha \in \Phi,\ \varepsilon_1, \varepsilon_2 \in R^*; \label{rel:h-mult} \\
& \phantom{[} h_\alpha(\varepsilon)x_\beta(\xi)h_\alpha(\varepsilon)^{-1} = x_\beta\left(\varepsilon^{\langle\beta,\alpha\rangle}\xi\right), && \alpha, \beta \in \Phi,\ \varepsilon \in R^*, \xi \in R. \label{rel:h-w}
\end{alignat}

\subsection{Representations of Chevalley groups} \label{sec:repr}
Our notation and terminology pertaining to representations of Chevalley groups follows \cite[\S~1.4]{PSV98} and \cite[\S~I.2]{Ma69})
Let $\pi$ be an irreducible representation of $\G(\Phi, R)$ acting on a free $R$-module $V$.
We denote by $\Lambda=\Lambda(\pi)$ the set of weights of $\pi$ and by $\Lambda(\pi)^*$ the subset of non-zero weights.
Denote by $V_\lambda \leq V$ the \emph{weight subspace} corresponding to $\lambda\in\Lambda(\pi)$ and denote by $m_\lambda$ the dimension of $V_\lambda$.

A representation $\pi$ is called \emph{basic} if for every pair of non-zero weights $\lambda, \mu \in \Lambda^*(\pi)$ such that $\lambda - \mu \in \Pi$ one has $\sigma_\alpha(\lambda) = \mu$.
Obviously, this is equivalent to saying that $W(\Phi)$ acts transitively on $\Lambda(\pi)^*$.

The irreducible representations of Chevalley groups used in these paper form a sublist of~\cite[Table~2]{PSV98}.
More specifically, all of them are \emph{fundamental} (i.\,e. their highest weight is fundamental) and basic.
We widely employ the technique of \emph{weight diagrams} (see~\cite[\S~2]{PSV98}) to help visualize the structure of these representations.
In the simplest case of a \emph{microweight} representation $\pi$ (i.\,e. $\pi$ such that $V_0 = 0$)
the weight diagram of $(V, \pi)$ is just an undirected graph whose vertices are in one-to-one correspondence with the elements of $\Lambda(\pi)$.
Two vertices $\lambda$, $\mu$ of the diagram are joined by a bond marked $i$ iff $\lambda-\mu = \alpha_i$.

An immediate application of weight diagrams is that they allow one to quickly read off the branching of a given basic representation with respect to a subsystem subgroup.
If $J$ is a subset of $\Pi$ and $\Delta$ is the subsystem of $\Phi$ spanned by $J$ then the weight diagram of $\pi$ restricted to $G(\Delta, R)$ can be obtained
from the weight diagram of $\pi$ by simply removing all the bonds whose label $i$ is such that $\alpha_i\not\in J$ (cf.~\cite[\S~2.7]{PSV98}).
 
Recall that all nonzero weights of a basic representation have multiplicty one and the multiplicity $m_0$ of the zero weight subspace equals $|\Delta(\pi)|$, where $\Delta(\pi)= \Lambda(\pi)^* \cap \Pi$ (see~\cite[Lemma~2.1]{Ma69}).
For $\alpha \in \Phi$ one can define certain elements $e_0(\alpha) \in V_0$ and $\alpha_* \in V_0^* = \Hom_R(V_0, R)$
and choose some set of vectors $E^* = \{ e_\lambda \}_{\lambda \in \Lambda^*(\pi)}$ in such a way that 
$E_\pi = E^* \cup \{ e_0(\alpha) \}_{\alpha \in \Delta(\pi)}$ forms a basis of $V$ in which the action of elementary root unipotents $x_\alpha(\xi)$ has particularly simple description.

\begin{lemma}[{\cite[Lemma~2.3]{Ma69}}]\label{lemma:Matsumoto}
Let $(V, \pi)$ be a basic representation of $\G(\Phi, R)$.
Then the action of $x_\alpha(\xi)$ is described by the following formulae.
\newline \begin{tabular}{ll}
If $\lambda\in\Lambda(\pi)^*,\ \lambda+\alpha\notin\Lambda(\pi)$, then & $x_\alpha(\xi)e_\lambda=e_\lambda$; \\
If $\lambda,\lambda+\alpha\in\Lambda(\pi)^*$, then & $x_\alpha(\xi)e_\lambda=e_\lambda\pm\xi e_{\lambda+\alpha}$; \\
If $\alpha\notin\Lambda(\pi)^*$, then & $x_\alpha(\xi)v_0=v_0$ for any $v_0\in V_0$; \\
If $\alpha\in\Lambda(\pi)^*$, then & $x_\alpha(\xi)e_{-\alpha} = e_{-\alpha}\pm\xi e_0(\alpha)\pm\xi^2 e_\alpha$ and \\
                                   & $x_\alpha(\xi)v_0         = v_0\pm\xi\alpha_*(v_0)e_\alpha$ for $v_0 \in V_0$.
\end{tabular} \end{lemma}

The action of $x_\alpha(\xi)$ can be visualized on a weight diagram of $\pi$ as follows. Blah-blah-blah
\textbf{TODO: Write a passage about this} %TODO:

Notice that the highest weight of natural representations of classical groups is $\varpi_1$.
It will be convenient for us to number the weights of these representations as in~\cite[\S~1B]{St78}:
\[\begin{array}{cll}
  1,2,\ldots, \ell+1 & \text{in the case} & \Phi =\rA_\ell, \\
  1,2,\ldots \ell, 0, -\ell,\ldots, -2, -1 & \text{in the case} & \Phi =\rB_\ell, \\
  1,2,\ldots \ell, -\ell,\ldots, -2, -1 & \text{in the cases}   & \Phi =\rC_\ell, \rD_\ell. \\
\end{array}\]
For example, we write $1$ instead of $\varpi_1$, $2$ instead of $\varpi_1-\alpha_1$ etc.

Although it is possible to fix signs of the action constants in the statement of \cref{lemma:Matsumoto} in the general situation (see~\cite{V08}),
for our purposes it suffices to do that only for classical groups in their natural representations.

\begin{rem}
Let $\lambda_1, \lambda_2 \in \Lambda(\pi)$ be a pair of weights of a representation $\pi$ of a classical group such that $\lambda_1-\lambda_2\in \Phi$.
In this situation it will be convenient for us to write $x_{\lambda_1,\lambda_2}(\xi)$ (for some choice of $\lambda_1,\lambda_2$) instead of $x_{\lambda_1-\lambda_2}(\xi)$.
For example, for $\Phi=\rA_\ell$ we have $x_{1,2}(\xi)=x_{1-2}(\xi)=x_{\varpi_1 - \varpi_1 + \alpha_1}(\xi) = x_{\alpha_1}(\xi)$. \end{rem}
For classical groups there is a standard way to fix the signs.
In case $\Phi=\rC_\ell$ the long and short root unipotents are
\begin{align*}
& x_{i,-i}(\xi)=e+\xi e_{i,-i}, \\ 
& x_{i,j}(\xi)=e+\xi e_{ij}-\varepsilon_i\varepsilon_j\xi e_{-j,-i},\quad i\neq\pm j.
\end{align*}
Here $\varepsilon_i$ is the sign of $i$.
In case $\Phi=\rB_\ell,\rD_\ell$ the long and short root unipotents in $\SO(n,R)$ are
\begin{align*}
& x_{i,j}(\xi)=e+\xi e_{ij}-\xi e_{-j,-i},\quad i\neq\pm j,\ i,j\neq0, \\
& x_{i0}(\xi)=e+2\xi e_{i0}-\xi e_{0,i}-\xi^2 e_{i,-i},\quad i\neq0.
\end{align*}

\subsection{Relative Chevalley groups}\label{sec:relative-elementary}
Recall from the introduction that the elements $z_\alpha(s, \xi) = x_\alpha(s)^{x\ssub{-\alpha}(\xi)}$ generate $\E(\Phi, R, I)$ as an abstract group.

\begin{lemma}[{\cite[Corollary~3.3]{S}}]\label{lemma:Stepanov-ideal}
Let $\Phi$ be a root system of rank $\geqslant2$, let $R$ be a commutative ring and $I\trianglelefteq R$ be its ideal.
If $\Phi\neq\rC_\ell$ then $\E\left(\Phi,R,I^2\right)\leqslant\E(\Phi,I)$, otherwise $\E\left(\Phi,R,II^{\indexbox{2}}\right)\leqslant\E(\Phi,I)$.
\end{lemma}
Here $I^{\indexbox{2}}$ denotes the ideal generated by squares $a^2$, where $a\in I$.
Recall also that $I^2$ is generated by products $ab$ for all $a,b\in I$.
Clearly, $II^{\indexbox{2}}$ is generated by elements of the form $a^2b$ for $a,b\in I$.

For a special subset of roots $\Sigma\subseteq \Phi$ we denote by $\U(\Sigma, I)$ the subgroup spanned by all $x_{\alpha}(I)$ for $\alpha\in \Sigma$. Let $J\subset\Pi$.
The subgroup $\U(\Sigma_J, I)$ is normalized by $\E(\Delta_J, R)$, hence the Minkowski product set $\EP_J(R, I) = \E(\Delta_J, R, I) \cdot \U(\Sigma_J, I)$ is a subgroup called a \emph{standard parabolic subgroup}.
The following two equalities will be referred to in the sequel as {\it Levi decomposition}: 
\begin{equation} \label{rel:Levi-decomp} \EP_J(R, I) = \U(\Sigma_J, I) \cdot \E(\Delta_J, R, I) = \E(\Delta_J, R, I) \cdot \U(\Sigma_J, I). \end{equation}
When $J = \{ \alpha_s \}$ for some $1 \leq s\leq \ell$ we use shorthand $\EP_s(R, I)$ for $\EP_{\{s\}}(R, I)$.
When $I=R$ we also write $\EP_J(R)$ instead of $\EP_J(R, R)$.

Denote by $\Hh(\Phi,R)$ the subgroup generated by all $h_\alpha(\varepsilon)$, $\alpha\in\Phi$, $\varepsilon\in R^*$, and set
\[ \Hh(\Phi,R,I) = \Hh(\Phi,R)\cap\G(\Phi,R,I)=\langle h_\alpha(\varepsilon),\ \alpha\in\Phi,\ \varepsilon\in R^*\cap(1+I)\rangle. \]
\begin{lemma}\label{lemma:rel-tor-elementary}
$\Hh(\Phi,R,I)$ is contained in $\E(\Phi,R,I)$.
\end{lemma}
\begin{proof}
Set $\varepsilon=1+s$, $s\in I$ and write
\begin{multline*}
h_\alpha(1+s) = x_\alpha\left(-1\middle)\, x_{-\alpha}\middle(-s\middle)\, x_\alpha\middle((1+s)^{-1}\middle)\, x_{-\alpha}\middle(s(1+s)\right) = \\
= x_\alpha\left((1+s)^{-1}-1\middle)\, z_{-\alpha}\middle(-s,(1+s)^{-1}\middle)\, x_{-\alpha}\middle(s(1+s)\right).
\end{multline*}
It remains to note that $(1+s)^{-1}\in 1+I$ and so all the factors lie in $\E(\Phi,R,I)$.
\end{proof}

The following lemma is a relative version of the classical result sometimes called Chevalley---Matsumoto decomposition.
\begin{lemma}\label{lemma:Chevalley-Matsumoto}
Let $\pi$ be the fundamental representation of $\G_{sc}(\Phi, R)$ with the highest weight $\varpi_s$.
Assume that $g\in \G_{sc}(\Phi, R, I)$ is such that $(g\cdot v^+)_{\varpi\ssub{s}}=1$, then 
\[ g \in \U(\Sigma_s^-, I) \cdot \G_{sc}(\Delta_s, R, I) \cdot \U(\Sigma_s^+, I). \]
\end{lemma}
\begin{proof}
In the absolute case ($I=R$) the statement of the lemma is contained in~\cite[Theorem~1.3]{St78}. 
Thus we can write $g=u_1\cdot g'\cdot u_2$, where $u_1\in\U(\Sigma_s^-,R)$, $u_2\in\U(\Sigma_s^+,R)$ and $g'\in\G(\Delta_s,R)$.
Since $g$ lies in $\G(\Phi,R,I)$, the vector $gv^+$ is $I$-unimodular. 
On the other hand, $g'u_2v^+=v^+$, so $u_1\in\G(\Phi,R,I)\cap\U(\Sigma_s^-,R)=\U(\Sigma_s^-,I)$.
The matrix $g'u_2$ is an element of $\left(\G(\Delta_s,R)\U(\Sigma_s^+,R)\right)\cap\G(\Phi,R,I)$, and by Levi decomposition $u_2\in\U(\Sigma_s^+,I)$, $g'\in\G(\Delta_s,R,I)$.
\end{proof}

\subsection{$\K_1$-functor modeled on Chevalley groups}
Recall that by Taddei's theorem $\E(\Phi, R)$ is a normal subgroup of $\G_{sc}(\Phi, R)$ provided $\Phi$ is an irreducible root system of rank $\geqslant 2$ (see~\cite{Ta}).

Using standard relativization argument it is not hard to deduce from Taddei's result that $\E(\Phi,R,I)$ is normal in $\G(\Phi,R,I)$ under the same assumptions on $\Phi$.
This allows us to define the relative $\K_1$-group as $\K_1(\Phi,R,I)=\G(\Phi,R,I)/\E(\Phi,R,I).$
When $I=R$, we write $\K_1(\Phi, R)$ for $\K_1(\Phi, R, R)$.

In some cases it is known that $\K_1(\Phi, R, I)$ is trivial.
For example, $\SK_1(\ell+1,R)=\K(\rA_\ell,R)=1$ for any ring of stable rank $1$ (see section~\ref{sec:stability-conditions}), 
and for other root systems some stronger assumption is required such as $\asr(R)=1$ or being semilocal. 
For any Euclidean ring $\K_1(\Phi, R, I)$ is trivial for every root system $\Phi$.

Let $k$ be a global field, $S$ be a set of places of $k$, 
$\mathcal{O}_S$ be the Dedekind ring of arithmetic type defined by $S$ and $I$ be an ideal of $\mathcal{O}_S$.
\begin{prop} \label{prop:K1triv}
Let $\Phi$ be a root system of rank $\geqslant2$. Assume that the field $k$ has a real embedding. Then $\K_1(\Phi,\mathcal{O}_S,I)=1$.
\end{prop}
\begin{proof} Follows from \cite[Theorem~3.6]{BassMilnorSerre} and \cite[Corollary~4.5]{Ma69}. \end{proof}

\section{Stability conditions}\label{sec:stability-conditions}
\input{stability-conditions}

\section{Relative parabolic factorizations} \label{sec:factorizations}
%TODO: Add references to works of Dennis, Bass, Vaserstein, Suslin etc.
In this section we formulate and prove relative versions of decompositions from~\cite{St78} which will be our main technical tools throughout the next section.

\subsection{Relative Gauss decomposition}\label{sec:gauss}
\input{gauss}
\subsection{Relative Bass---Kolster decompositions}\label{sec:bass-kolster}
\input{bass-kolster}
\subsection{Relative Dennis---Vaserstein decompositions}\label{sec:dennis-vaserstein}
\input{dennis-vaserstein}

\section{Applications} \label{sec:applications}
\subsection{Bounded generation}\label{sec:boundgen}
\input{congrsubgr-boundgen}
\subsection{Subsystem factorizations}\label{sec:subsysfact}
\input{subsystem-factorizations}

\printbibliography

\end{document}
