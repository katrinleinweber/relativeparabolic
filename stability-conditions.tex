In this section we define stability conditions used in the statements of our decomposition theorems from section~\ref{sec:factorizations}.
First, we recall the notion of the stable rank of an ideal introduced by L.~Vaserstein in~\cite{Va69, Va71}.
As we will be mainly concerned with applications to Chevalley groups, our exposition of stable ranks is neccessarily limited to commutative rings.
The main goal of the subsection~\ref{sec:rel-asr} is to define the relative version of the absolute stable rank condition which generalizes the definition of~\cite{EO, MKV}.
Finally, in the end of this section we state several technical lemmas describing the action of certain unipotent radicals on unimodular columns under stability conditions.

\subsection{Relative stable rank}
Recall that a row $a\in{}^n\!R$ is called \emph{$I$-unimodular} if it is congruent to $e_1$ modulo $I$ and its components $a_1,a_2,\ldots,a_n$ generate $R$ as an ideal.
A column $b \in R^n$ is called $I$-unimodular if its transpose $b^t$ is an $I$-unimodular row.
We denote the set of all $I$-unimodular rows (resp. columns) by $\Umd(n, I)$ (resp. $\Ums(n, I)$).
When $R=I$ we refer to $R$-unimodular rows and columns as simply unimodular.

It is not hard to show that for an $I$-unimodular row $a$ there exists an $I$-unimodular column $b$ such that $ab=1$ (see~\cite[\S~2]{Va69}).

An $I$-unimodular row $a=(a_1,\ldots a_{n+1})$ is called \emph{stable} if one can choose $b_1,\ldots,b_n\in I$ such that the row $(a_1+a_{n+1}b_1,\ldots,a_n+a_{n+1}b_n)$ is also $I$-unimodular. 
We say that $I$ satisfies stable range condition $\SR_n(I)$ if any $I$-unimodular row of length $n+1$ is stable.
It is easy to see that $\SR_n(I)$ implies $\SR_m(I)$ for any $m\geqslant n$. 
It is also clear that condition $\SR_n(I)$ does not depend on the choice of the ambient ring $R$.
By definition, the {\it stable rank} of $I$ (denoted $\sr(I)$) is the smallest natural $n$ such that $\SR_n(I)$ holds (we set $\sr(I)=\infty$ if no such $n$ exists).

The following proposition summarizes basic properties of stable ranks.
\begin{prop} \label{prop:sr_properties}
Let $R$ be arbitrary commutative unital ring and let $I\trianglelefteq R$ be an ideal.
\begin{enumerate}
\item For any ideal $J\subseteq I$ one has $\sr(J)\leqslant\sr(I)$, $\sr(I/J)\leqslant\sr(I)$;
\item One has $\sr\Bigl(\prod\limits_{i=1}^n R_i\Bigr)=\max\limits_{i=1}^n\bigl(\sr(R_i)\bigr)$;
\item Let $J$ denote the Jacobson radical of $R$, then one has $\sr(R)=\sr(R/J)$;
\item If $I\subseteq J$, then $\sr(I)=1$;
\item Let $I\rtimes\mathbb{Z}$ denote the ring obtained by formally adjoining $1$ to $I$. Then $\sr(I\rtimes\mathbb{Z})=\max(2,\sr(I))$.
\end{enumerate}
\end{prop}
\begin{proof} See~\cite[Theorem~2.3]{Va69}, \cite{Va71}. 
\end{proof}
\begin{example}
Since the stable rank of a field equals $1$, one can conclude from the previous proposition that $\sr(R)=1$ for any semilocal ring $R$.
Other examples of rings of stable rank $1$ are provided by boolean rings, the ring of algebraic integers, the ring of entire functions, the disk-algebra, etc. For this and many other examples see~\cite{VasSR1}.

%Formally adjoining a unit to a non-unital ring of stable rank $1$ produces a non-trivial example of an ideal having the stable rank strictly lower that the ambient ring.
\end{example}

\subsection{Relativization of the absolute stable rank}\label{sec:rel-asr}
For a row $a=(a_1,\ldots,a_n)\in{}^n\!R$ denote by $\mathfrak{J}(a)$ the intersection of all maximal ideals of $R$ containing $a_1,\ldots,a_n$.
It is easy to see that a row $a\in R^n$ is unimodular if and only if $\mathfrak{J}(a)=R$. 
Clearly, for any $g\in\GL(n,R)$ one has $\mathfrak{J}(a\cdot g)=\mathfrak{J}(a)$.
\begin{dfn}\label{dfn:j-stable}
We say that a row $a=(a_1,\ldots,a_{n+1})\in{}^{n+1}\!I$ is {\it $\mathfrak{J}$-stable}, if there exist $c_1,\ldots,c_n\in I$ such that
$\mathfrak{J}(a_1,\ldots,a_{n+1})=\mathfrak{J}(a_1+c_1a_{n+1},\ldots,a_n+c_na_{n+1}).$
\end{dfn}
\begin{dfn}\label{dfn:asr}
We say that an ideal $I$ satisfies condition $\ASR_n(I)$ if it satisfies $\SR_n(I)$ and, moreover, any row $a\in{}^{n+1}\!I$ is $\mathfrak{J}$-stable.
\end{dfn}

It is easy to see that $\ASR_m(I)$ implies $\ASR_n(I)$ for any $n\geqslant m$. 
By definition, the \emph{absolute relative stable rank} $\asr(I)$ is the smallest natural $n$ such that $\ASR_n(I)$ holds. 
Similarly to the case of usual stable rank, we set $\asr(I)=\infty$ if no such $n$ exists.

A priori our definition of $\ASR_n(I)$ depends on $R$.
Below we will see that, in fact, there is no such dependence.
The following lemma is a relativization of~\cite[Lemma~8.2]{MKV}. 
\begin{lemma}\label{lemma:relative-asr-unimod}
For a commutative ring $R$ and an ideal $I \leq R$ the following statements are equivalent:
\begin{lemlist} 
\item\label{asr-j-stable} Any row $a\in{}^{n+1}\!I$ is $\mathfrak{J}$-stable;
\item\label{asr-bak-like} For any $I$-unimodular row $(b,a_1,\ldots,a_n,d)\in\Umd(n+2,I)$ there exist $c_1,\ldots,c_n\in I$ 
 such that $(b+b',a_1+c_1d,\ldots,a_n+c_nd)$ is $I$-unimodular for any $b'\in J$, where $J=I \cdot a_1 + \ldots + I \cdot a_n + I \cdot d\leq I$.
\end{lemlist} 
\end{lemma}
\begin{proof}
Assume first that any row $a\in{}^{n+1}\!I$ is $\mathfrak{J}$-stable. 
In particular for a given $I$-unimodular row $(b,a_1,\ldots,a_n,d)\in\Umd(n+2,I)$ there exist $c_1,\ldots,c_n$ such that
\[\mathfrak{J}(a_1,\ldots,a_{n+1})=\mathfrak{J}(a_1+c_1a_{n+1},\ldots,a_n+c_na_{n+1}).\]
Therefore $(b,a_1+c_1d,\ldots,a_n+c_nd)$ is also unimodular. Of course, for any $b'\in J$ we could replace $b$ with $b+b'$ from the very start.

To show the converse take arbitrary row $(a_1,\ldots,a_n,d)\in{}^{n+1}\!I$ and consider $I$-unimodular row $(1,a_1,\ldots,a_n,d)\in\Umd(n+2,I).$
By hypothesis, there exist $c_1,\ldots,c_n$ such that \[ v=(1+b',a'_1,\ldots,a'_n)=(1+b',a_1+c_1d,\ldots,a_n+c_nd) \] is unimodular for any $b'\in J$.
Assume that there exists a maximal ideal $\mathfrak{m}\trianglelefteq R$ such that all $a'_1,\ldots,a'_n$ are contained in $\mathfrak{m}$
 but at least one of the elements $d$, $a_i$ is not.
Clearly then $d\notin\mathfrak{m}$ and $I\not\subseteq \mathfrak{m}$ (otherwise $a_i=a'_i-c_id\in\mathfrak{m}$ contrary to the assumption).
Now we can find $t\in I$ such that its image $\bar{t}$ in the residue field $R/\mathfrak{m}$ equals $-\bar{1}/\bar{d}$.
We get that $1 + b' \in \mathfrak{m}$ for $b'=td\in J$ which contradicts unimodularity of $v$.
This shows that no such $\mathfrak{m}$ may exist and, therefore, $\mathfrak{J}(a'_1,\ldots,a'_n)=\mathfrak{J}(a_1,\ldots,a_n,d)$.
\end{proof}

Obviously, the second statement of \cref{lemma:relative-asr-unimod} does not depend on $R$, hence, as suggested by the notation, $\asr(I)$ is independent of $R$.
%As another corollary of \cref{lemma:relative-asr-unimod} we obtain the following reformulation of the absolute stable rank condition $\ASR_n(R)$.
%\begin{cor}[A.~Bak, {cf.~\cite[\S~1]{Pl98}}] For a commutative ring $R$ the following statements are equivalent:
%\begin{enumerate}
% \item\label{asr_Stein} $R$ satisfies $\ASR_n(R)$;
% \item\label{asr_Bak} For any \emph{unimodular} row $(a_1,\ldots,a_n,b,d)\in\Umd(n+2,R)$ there exist $c_1,\ldots,c_n\in R$ such that $(a_1+c_1d,\ldots,a_n+c_nd,b+td)$ is unimodular for all $t\in R$.
%\end{enumerate}
%\end{cor}

Let $R$ be a commutative ring. We denote by $\Max(R)$ its \emph{maximum spectrum} i.e. the set of maximal ideals of $R$ equipped with Zariski topology. For a topological space $X$ denote by $\dim(X)$ its usual topological dimension.
The following result gives an upper estimate for the absolute stable rank (see~).
%\begin{prop}\label{prop:asr-dimmax}
%Let $R$ be a commutative ring whose maximum spectrum $\Max(R)$ can be covered with a finite family of subsets 
%$X_1\ldots, X_m$ such that $\dim(X_i)\leqslant d$ for every $i$. Then $\asr(A)\leqslant d+1$.
%\end{prop}
From the definition of $\asr(I)$ and \cite[Theorem~2.3]{EO} (or~\cite[Theorem~3.7]{MKV}) it follows that
\begin{equation} \label{sr-estimates}
\sr(I)\leqslant\asr(I)\leqslant\asr(R)\leqslant \dim(\Max(R))+1\leqslant\dim(\Spec(R))+1.
\end{equation}
\begin{rem}
There exist examples of rings for which the first inequality in the above formula is strict. Namely, there are rings of stable rank $1$ but of absolute stable rank $\geqslant2$, see~\cite{MKV}. However, \cite[Theorem~1.3]{MKV} shows that $\sr(R)=\asr(R)$ for any principal ideal ring $R$.
\end{rem}
\begin{example}
\eqref{sr-estimates} shows in particular, that every Dedekind domain $R$ satisfies $\asr(R)\leqslant2$, and that $\sr(A[x])\leqslant3$ for every locally principal ring $A$. It is shown in \cite{GruMenVasSL2ZxSL2kxy} that $\sr(\mathbb{Z}[x])=3$. Note that $\sr(\mathbb{Z}[x_1,\ldots,x_n])=n+1$ if $n>1$ \cite[Example after Theorem~18.2]{VasSusSerreProblem}.

Another corollary of \eqref{sr-estimates} is an estimate for the stable rank of the polynomial rings over a field.
Namely, $\sr(F[x_1,\ldots,x_n])\leqslant n+1$ for any field $F$.
For certain classes of fields this upper estimate can be further improved.
For example, if $F$ is algebraic over a finite field then $\sr(F[x_1,\ldots,x_n])\leqslant n$ by~\cite[Corollary~17.4]{VasSusSerreProblem}.
On the other hand, it is known that $\sr(F[x,y])=3$ for every $F$ with $\K_2^M(F)\neq0$ \cite{KrusenmeyerThesis} and $\sr(F[x_1,\ldots,x_n])=n+1$ for $F\subseteq\mathbb{R}$, see~\cite[Theorem~8]{Va71}.
\end{example}

\subsection{Action of unipotent radicals}\label{sec:ur-action}
\begin{lemma}\label{lemma:PSV-symplectic-trick}
 Let $v=(v_1,\ldots, v_n)^t$ be a column. Denote by $v'$ the vector composed of squares of the components of $v$, i.\,e. $v'=(v_1^2, \ldots, v_n^2)^t$.
 Then for any matrix $b \in M(n, I)$ one can find a symmetric matrix $a \in M(n, I)$, $a=a^t$ such that $b \cdot v' = a \cdot v$. \end{lemma}
\begin{proof}
Straightforward computation shows that the assertion of lemma holds for the matrix $a$ defined by
\begin{equation*}
a_{ij} = b_{ij} v_{j} + b_{ji} v_{i},\ j\neq i,\quad a_{ii} = b_{ii} v_{i} - \sum\limits_{\mathclap{\substack{j=1 \\ j\neq i}}}^\ell b_{ji} v_{j}. \qedhere
\end{equation*}
%$$(av)_k = \sum\limits_{i=1,\ i\neq k}^\ell \left( b_{ki} v_{i} + b_{ik} v_{k} \right)v_{i}  +
%\left(b_{kk}v_{k} - \sum\limits_{i=1,\ i\neq k}^\ell b_{ik} v_{i}\right)v_{k} = \sum\limits_{i=1}^\ell b_{ki} v_{i}^2 = (bv')_k$$
\end{proof}

Let $v\in V=R^{2\ell}$ be a vector of the natural representation of $\G(\rD_\ell, R)$.
Denote by $v_+$ and $v_-$ the upper and the lower halves of $v$, i.e. $v_+=(v_1,\ldots, v_\ell)^t$, $v_-=(v_{-\ell},\ldots, v_{-1})^t$.
\begin{lemma}\label{lemma:asrUnip}
For any $I$-unimodular column $v=(v_+, v_-)^t\in\Ums(2\ell, I)$ there exists $g\in\U(\Sigma^+_\ell, I) \leq \E(\Phi, R, I)$ 
such that $(g \cdot v)_+ \in \Ums(\ell, I)$ under the following assumptions on $\Phi$ and $I$.
\begin{lemlist}
\item \label{item:asrUnipC} $\Phi=\rC_\ell$ and $\sr(I) \leqslant \ell$;
\item \label{item:asrUnipD} $\Phi=\rD_\ell$ and $\asr(I)\leqslant \ell -1$.
\end{lemlist}
\end{lemma}
\begin{proof} 
\textsc{Case $\Phi=\rC_\ell$.}
Denote by $p$ the matrix of size $\ell$ such that its only nonzero entries equal $1$ and are on the skew-diagonal, i.\,e. $p_{ij}=(\delta_{i, \ell-j+1})$. 
For $b \in M(\ell, I)$ set $g(b)=\left(\begin{smallmatrix} e_\ell & p \cdot b \\ 0 & e_{\ell} \end{smallmatrix}\right)$.
Clearly, if $b$ is symmetric then $g(b)$ lies in $\U(\Sigma_\ell^+, I)\leq \E(\rC_\ell, R, I)$.

Notice that the column $v'=(v_1,\ldots,v_\ell, v_{-\ell}^2,\ldots,v_{-1}^2)^t$ is $I$-unimodular.
By the definition of the relative stable rank we can find a matrix $b\in \M(\ell,I)$ such that the upper half $v''_+$ of the vector $v''= g(b) \cdot v'$ is $I$-unimodular.
It is clear that $v''_+ = v_+ + pb v'_-$. 
Finally, applying \cref{lemma:PSV-symplectic-trick} we find a symmetric matrix $a$ such that
$$(g(a)\cdot v)_+=v_+ + pav_- = v_+ + pbv'_- = v''_+ \in \Ums(\ell, I).$$

\textsc{Case $\Phi=\rD_\ell$.} Denote by $J$ the ideal of $R$ spanned by the components of $v_{-}$. Clearly, $J \subseteq I$.
By \cref{prop:sr_properties} $\sr(I/J) \leqslant \ell-1$, therefore
the elementary group $\E(\rA_{\ell-1}, R/J, I/J)$ acts transitively on $\Ums(\ell, I/J)$ (see~\cite[Theorem~2.3c]{Va69}). 
This implies the existence of an element $h\in \E(\Delta_\ell, R, I)$ such that the vector $v' = h \cdot v$ satisfies $v'_i \equiv \delta_{i1} \pmod J$ for $i=1,\ldots, \ell$.

Clearly, $(v'_1,v'_{-\ell},\ldots, v'_{-1})$ is $I$-unimodular.
Applying \cref{asr-bak-like} we find $c_2,\ldots, c_\ell\in I$ such that for $v''= \prod_{i=2}^{\ell}x_{-i, -1}(c_i)\cdot v'$ one has
$(v''_1, v''_{-\ell},\ldots, v''_{-2})\in\Ums(\ell+1, I)$.
Now, applying the condition $\sr(I) \leqslant \ell-1$ once again we find
$d_1,d_3,\ldots, d_{\ell}\in I$ such that the entries $(v'''_1, v'''_{-\ell},\ldots, v'''_{-3})$
of $v'''=x_{-2,1}(d_1) \cdot \prod_{i=3}^{\ell} x_{-2,-i}(d_i) \cdot v''$ form an $I$-unimodular column.

We can find $f_1, f_3,\ldots, f_\ell \in R$ such that $f_1v'''_1+\sum_{i=3}^\ell f_i v'''_{-i} = 1$.
Set $\xi = v'''_1-v'''_2-1 \in I$, $v^{(4)}=x_{1,2}(\xi f_1) \cdot \prod_{i=3}^\ell x_{-i,2}(\xi f_i) \cdot v'''$.
Clearly $v^{(4)}_2 = v^{(4)}_1-1$, therefore $v^{(4)}_+$ is $I$-unimodular.
Summarizing the above, we have found $g\in \EP_\ell(R, I)$ such that $v^{(4)}=g \cdot v$
and the assertion of the lemma immediately follows from Levi decomposition. \end{proof}

\begin{cor} \label{cor:embeddingBD}
 Denote by $i$ the standard embedding $\G(\rB_{\ell-1}, R, I) \hookrightarrow \G(\rD_\ell, R, I)$. 
 If $\asr(I) \leqslant \ell-1$ then for every $I$-unimodular column $v \in \Ums(2\ell, I)$ there exists $g \in \U(\Sigma_{\ell-1}^+, I) \leq \E(\rB_{\ell-1}, R, I)$ such that
 the upper half of the vector $i(g) \cdot v$ forms an $I$-unimodular column of height $\ell$.
\end{cor}
\begin{proof}
 The assertion follows from the fact that for every $u \in \U(\Sigma_\ell^+, I) \leq \E(\rD_\ell, R, I)$ one can find $u' \in \G(\Delta_\ell, R, I)$ such that $uu'$ lies in the image of $i$. 
 Indeed, denote by $\sigma$ the symmetry of the Dynkin diagram of $\rD_\ell$,
 and decompose $u$ into the product $u_1 \cdot u_2$, $u_1 \in \U(\Sigma_\ell^+\cap\Delta_{\ell-1}, I)$, $u_2 \in \U(\Sigma_\ell^+ \cap \Sigma_{\ell-1}^+, I)$.
 Then one takes $u' = \sigma(u_1)$.

 Now by \cref{item:asrUnipD} one finds a suitable $u \in \U(\Sigma_\ell^+, I) \leqslant \E(\rD_\ell, R, I)$ which makes the upper half unimodular,
 and since $u'$ lies in $\G(\Delta_\ell, R, I)$, the upper half remains unimodular.
\end{proof}

\begin{lemma} \label{lemma:uraction} 
Let $\Phi=\rA_\ell, \rC_\ell, \rD_\ell$. Denote by $\pi$ the natural representation of $\G(\Phi, R)$ on $V=R^n$, $n=\ell+1,2\ell$.
Assume that one of the following conditions holds:
\begin{lemlist}
 \item \label{item:uractionA} $\Phi=\rA_\ell$, $\Gamma=\{ k+1, \ldots, \ell+1\} \subset \Lambda(\pi)$ and $\sr(I)\leq k\leq \ell$;
 \item \label{item:uractionC} $\Phi=\rC_\ell$, $\Gamma=\{-\ell,\ldots, -2, -1\} \subset \Lambda(\pi)$ and $\sr(I)\leq \ell$. 
 \item \label{item:uractionD} $\Phi=\rD_\ell$, $\Gamma=\{-\ell,\ldots, -2, -1\} \subset \Lambda(\pi)$ and $\asr(I)\leq \ell-1$. 
\end{lemlist}
Then for $g\in \G(\Phi, R, I)$ there exist $x\in \U(\Phi^+, I)$, $y\in \U(\Phi^-, I)$ such that $(yxg \cdot v^+)_\lambda = 0$ for $\lambda\in \Gamma$.
\end{lemma}
\begin{proof} Denote by $v$ the image of the highest weight vector $v^+$ under $g$.

\textsc{Case $\Phi=\rA_\ell$.} From the definition of the relative stable rank it follows that we can find 
$x= \left(\begin{smallmatrix} e_k & a \\ 0 & e_{n-k} \end{smallmatrix}\right) \in \U(\Sigma_k^+, I)$ such that 
the upper $k$ components of $v'= x \cdot v$ form an $I$-unimodular column. 
Now, to obtain zeroes at desired positions it remains to subtract from $v'_{k+1},\ldots, v'_{\ell+1}$ suitable multiples of $v'_1,\ldots v'_k$.
Clearly, this operation corresponds to the left multiplication by some element $y\in\U(\Sigma_k^-, I)$.

\textsc{Case $\Phi=\rC_\ell$.} 
Applying \cref{item:asrUnipC} we find $x \in \U(\Sigma_\ell^+, I)$ such that the upper half $v'_+$ of $v' = x \cdot v$ is unimodular.
Set $g(a) = \left(\begin{smallmatrix} e_\ell & 0 \\ p \cdot a & e_{\ell} \end{smallmatrix}\right)$.
Clearly, if $a$ is symmetric then $g(a) \in \U(\Sigma_\ell^-, I)$.
Since the column $v''_+ = ({v'_1}^2, \ldots, {v'_\ell}^2)^t$ is $I$-unimodular there exists a matrix $b \in M(\ell, I)$ such that $v'_- + p b v''_+ = 0$.
Finally, using \cref{lemma:PSV-symplectic-trick} we find a symmetric matrix $a$ such that $(g(a) \cdot v')_- = p a v'_+ + v'_- = p b v''_+ + v'_- = 0$.

\textsc{Case $\Phi=\rD_\ell$.} From the proof of \cref{item:asrUnipD} it follows that there exists $h_1 \in \EP_\ell(R, I)$ such that for $v'=h_1\cdot v$ one has $v'_2=v'_1-1\in I$.
Clearly, for $v'' = z_{-\alpha\ssub{2}}(-v'_2, 1)\cdot v'$ one has $v''_1=1$ hence by \cref{lemma:Chevalley-Matsumoto} there exists $h_2 \in \U(\Phi^-, I)$ such that the element
$g'=h_2 \cdot z_{-\alpha\ssub{2}}(-v'_2, 1) \cdot h_1 \cdot g$ fixes $v^+$. 
Using Levi decomposition we can write $g'=h \cdot y \cdot x \cdot g$ for some $y\in\U(\Sigma^-_\ell, I)$, $x \in \U(\Sigma^+_\ell, I)$, $h\in\E(\Delta_\ell, R, I)$.
It is clear that $x$, $y$ are the desired elements.
\end{proof}